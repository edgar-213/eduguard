<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CASM-83 2.0 - Test Vocacional Interactivo con IA</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            color: #2D3436;
            padding: 20px;
            overflow-x: hidden;
            position: relative;
        }

        /* Part√≠culas flotantes */
        .particles { position: fixed; width: 100%; height: 100%; top: 0; left: 0; pointer-events: none; z-index: 1; }
        .particle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: rgba(255,255,255,0.5);
            border-radius: 50%;
            animation: float 15s infinite ease-in-out;
            box-shadow: 0 0 20px rgba(255,255,255,0.8);
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0) translateX(0); }
            25% { transform: translateY(-100px) translateX(50px); }
            50% { transform: translateY(-200px) translateX(-50px); }
            75% { transform: translateY(-100px) translateX(100px); }
        }

        .container { max-width: 1200px; margin: 0 auto; position: relative; z-index: 2; }
        
        header {
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(10px);
            padding: 40px;
            text-align: center;
            border-radius: 30px;
            margin-bottom: 30px;
            box-shadow: 20px 20px 60px rgba(0,0,0,0.3), -20px -20px 60px rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            animation: slideDown 0.8s ease;
        }
        
        @keyframes slideDown {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        h1 {
            font-size: 3rem;
            background: linear-gradient(45deg, #fff, #ffd700, #fff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-size: 200% auto;
            animation: shine 3s linear infinite;
            text-shadow: 0 0 30px rgba(255,255,255,0.5);
        }
        
        @keyframes shine {
            to { background-position: 200% center; }
        }
        
        .card {
            background: rgba(255,255,255,0.95);
            border-radius: 30px;
            padding: 40px;
            margin: 20px 0;
            box-shadow: 20px 20px 60px rgba(0,0,0,0.3), -20px -20px 60px rgba(255,255,255,0.5);
            border: 1px solid rgba(255,255,255,0.3);
            animation: fadeIn 0.6s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .form-group { margin-bottom: 20px; position: relative; }
        .form-group label { 
            display: block; 
            margin-bottom: 8px; 
            font-weight: 600; 
            color: #667eea;
            font-size: 1.1rem;
        }
        
        .form-control {
            width: 100%;
            padding: 15px 20px;
            border: none;
            border-radius: 15px;
            background: #f0f0f3;
            box-shadow: inset 8px 8px 16px rgba(163,177,198,0.6), inset -8px -8px 16px rgba(255,255,255,0.5);
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        .form-control:focus {
            outline: none;
            box-shadow: inset 8px 8px 16px rgba(102,126,234,0.3), inset -8px -8px 16px rgba(255,255,255,0.8);
        }
        
        /* Autocompletado */
        .autocomplete {
            position: relative;
        }
        
        .autocomplete-items {
            position: absolute;
            border: 1px solid #d4d4d4;
            border-bottom: none;
            border-top: none;
            z-index: 99;
            top: 100%;
            left: 0;
            right: 0;
            max-height: 200px;
            overflow-y: auto;
            border-radius: 0 0 15px 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .autocomplete-items div {
            padding: 12px 20px;
            cursor: pointer;
            background-color: #fff;
            border-bottom: 1px solid #d4d4d4;
        }
        
        .autocomplete-items div:hover {
            background-color: #f0f7ff;
        }
        
        .autocomplete-active {
            background-color: #667eea !important;
            color: #ffffff;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.3s;
            box-shadow: 8px 8px 16px rgba(163,177,198,0.6), -8px -8px 16px rgba(255,255,255,0.5);
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255,255,255,0.5);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .btn:hover::before {
            width: 300px;
            height: 300px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            width: 100%;
            margin-top: 10px;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #4ECDC4 0%, #06D6A0 100%);
            color: white;
            width: auto;
            margin: 10px auto;
            display: block;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #51CF66 0%, #2F9E44 100%);
            color: white;
        }
        
        .btn-info {
            background: linear-gradient(135deg, #5DADE2 0%, #3498DB 100%);
            color: white;
        }
        
        .btn:hover { transform: translateY(-3px); box-shadow: 12px 12px 24px rgba(163,177,198,0.8), -12px -12px 24px rgba(255,255,255,0.7); }
        .btn:active { transform: translateY(-1px); }
        
        .progress-container {
            margin: 30px 0;
            text-align: center;
        }
        
        .progress-circle {
            width: 150px;
            height: 150px;
            margin: 0 auto 20px;
            position: relative;
        }
        
        .progress-circle svg {
            transform: rotate(-90deg);
        }
        
        .progress-circle circle {
            fill: none;
            stroke-width: 10;
        }
        
        .progress-bg { stroke: #e0e0e0; }
        .progress-bar { 
            stroke: url(#gradient);
            stroke-linecap: round;
            transition: stroke-dashoffset 0.5s ease;
        }
        
        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem;
            font-weight: 700;
            color: #667eea;
        }
        
        .options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 30px 0;
        }
        
        .option {
            padding: 30px;
            border-radius: 20px;
            cursor: pointer;
            background: #f0f0f3;
            box-shadow: 8px 8px 16px rgba(163,177,198,0.6), -8px -8px 16px rgba(255,255,255,0.5);
            text-align: center;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            position: relative;
            overflow: hidden;
        }
        
        .option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.5s;
        }
        
        .option:hover::before { left: 100%; }
        .option:hover { transform: translateY(-5px) scale(1.03); }
        
        .option.selected {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 10px 30px rgba(102,126,234,0.5);
            animation: pulse 0.5s ease;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .option-icon { 
            font-size: 3rem; 
            margin-bottom: 15px;
            display: block;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .option:hover .option-icon { animation: spin 0.6s ease; }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            gap: 15px;
            margin-top: 30px;
        }
        
        .hidden { display: none !important; }
        
        .alert {
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            gap: 15px;
            animation: slideIn 0.5s ease;
            box-shadow: 8px 8px 16px rgba(163,177,198,0.4), -8px -8px 16px rgba(255,255,255,0.5);
        }
        
        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .alert-warning { background: linear-gradient(135deg, #FFD166 0%, #FFA500 100%); color: #333; }
        .alert-danger { background: linear-gradient(135deg, #FF6B6B 0%, #C92A2A 100%); color: white; }
        .alert-success { background: linear-gradient(135deg, #51CF66 0%, #2F9E44 100%); color: white; }
        
        .alert-icon { font-size: 2.5rem; }
        
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 250px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            border-radius: 10px;
            padding: 10px;
            position: absolute;
            z-index: 1000;
            bottom: 125%;
            left: 50%;
            margin-left: -125px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9rem;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        .area-card {
            background: #f0f0f3;
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            box-shadow: 8px 8px 16px rgba(163,177,198,0.6), -8px -8px 16px rgba(255,255,255,0.5);
            transition: all 0.3s;
            position: relative;
        }
        
        .area-card:hover {
            transform: translateY(-10px);
            box-shadow: 12px 12px 24px rgba(163,177,198,0.8), -12px -12px 24px rgba(255,255,255,0.7);
        }
        
        .area-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #f0f;
            position: fixed;
            top: -10px;
            animation: confetti-fall 3s linear forwards;
            z-index: 1000;
        }
        
        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        .time-warning {
            display: inline-block;
            padding: 8px 15px;
            border-radius: 10px;
            background: #FFD166;
            color: #333;
            font-size: 0.9rem;
            margin: 10px 0;
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .percentile-badge {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 700;
            margin: 5px;
            font-size: 0.9rem;
        }
        
        .percentile-high { background: linear-gradient(135deg, #51CF66, #2F9E44); color: white; }
        .percentile-medium { background: linear-gradient(135deg, #FFD166, #FFA500); color: #333; }
        .percentile-low { background: linear-gradient(135deg, #FF6B6B, #C92A2A); color: white; }
        
        @media (max-width: 768px) {
            .options { grid-template-columns: 1fr; }
            h1 { font-size: 2rem; }
            .nav-buttons { flex-direction: column; }
        }
        
        /* Modo sonido */
        .sound-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: rgba(255,255,255,0.9);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: all 0.3s;
        }
        
        .sound-toggle:hover { transform: scale(1.1); }
        
        /* Gr√°ficos */
        .chart-container {
            position: relative;
            height: 400px;
            margin: 30px 0;
        }
        
        .chart-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            gap: 10px;
        }
        
        .chart-tab {
            padding: 10px 20px;
            background: #f0f0f3;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        .chart-tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        /* Animaci√≥n de carga */
        .loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s;
        }
        
        .loader.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .loader-circle {
            width: 80px;
            height: 80px;
            border: 10px solid #f0f0f3;
            border-top: 10px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Medallas de logros */
        .achievement {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 10px;
            transform: translateX(400px);
            transition: transform 0.5s ease;
            z-index: 1000;
        }
        
        .achievement.show {
            transform: translateX(0);
        }
        
        .achievement-icon {
            font-size: 2rem;
        }
        
        .achievement-text {
            font-weight: 600;
            color: #333;
        }
        
        /* Secci√≥n de empresas */
        .company-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .company-card {
            background: white;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }
        
        .company-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.15);
        }
        
        .company-logo {
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            font-size: 2rem;
        }
        
        .company-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }
        
        .company-sector {
            font-size: 0.9rem;
            color: #666;
        }
        
        /* Secci√≥n collapsible */
        .collapsible {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            cursor: pointer;
            padding: 18px;
            width: 100%;
            border: none;
            text-align: left;
            outline: none;
            font-size: 1.2rem;
            font-weight: 600;
            border-radius: 15px;
            transition: all 0.3s;
            margin: 20px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .collapsible:hover {
            background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
        }
        
        .collapsible:after {
            content: '\002B';
            color: white;
            font-weight: bold;
            float: right;
            margin-left: 5px;
            font-size: 1.5rem;
        }
        
        .active:after {
            content: "\2212";
        }
        
        .content {
            padding: 0 18px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
            background-color: rgba(255,255,255,0.1);
            border-radius: 0 0 15px 15px;
        }
        
        .content.show {
            max-height: 2000px;
            padding: 20px;
        }
        
        /* Asistente Virtual */
        .chat-assistant {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .chat-button {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            font-size: 1.5rem;
            transition: all 0.3s;
        }
        
        .chat-button:hover {
            transform: scale(1.1);
        }
        
        .chat-window {
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 350px;
            height: 500px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            display: none;
            flex-direction: column;
            overflow: hidden;
        }
        
        .chat-window.show {
            display: flex;
        }
        
        .chat-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chat-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            background: #f8f9fa;
        }
        
        .chat-message {
            margin-bottom: 15px;
            display: flex;
            animation: slideIn 0.3s ease;
        }
        
        .chat-message.user {
            justify-content: flex-end;
        }
        
        .message-bubble {
            max-width: 70%;
            padding: 10px 15px;
            border-radius: 15px;
            background: #e9ecef;
            position: relative;
        }
        
        .chat-message.user .message-bubble {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .chat-input {
            padding: 15px;
            border-top: 1px solid #e0e0e0;
            display: flex;
            gap: 10px;
        }
        
        .chat-input input {
            flex: 1;
            padding: 10px;
            border: 1px solid #e0e0e0;
            border-radius: 20px;
            outline: none;
        }
        
        .chat-input button {
            padding: 10px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
        }
        
        /* Plan de Acci√≥n */
        .action-plan {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
        }
        
        .timeline {
            position: relative;
            padding: 20px 0;
        }
        
        .timeline::before {
            content: '';
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transform: translateX(-50%);
        }
        
        .timeline-item {
            position: relative;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
        }
        
        .timeline-item:nth-child(odd) {
            flex-direction: row-reverse;
        }
        
        .timeline-content {
            width: 45%;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .timeline-dot {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            border: 4px solid white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        .timeline-date {
            font-weight: 600;
            color: #667eea;
            margin-bottom: 10px;
        }
        
        /* Simulador de Carreras */
        .career-simulator {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .career-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .career-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            border-color: #667eea;
        }
        
        .career-card.selected {
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border-color: #667eea;
        }
        
        .career-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .career-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
        }
        
        .career-match {
            background: linear-gradient(135deg, #51CF66 0%, #2F9E44 100%);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
        }
        
        .career-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .career-stat {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .career-stat i {
            color: #667eea;
            font-size: 1.2rem;
        }
        
        /* Mapa de Oportunidades */
        .opportunity-map {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
        }
        
        .region-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .region-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s;
        }
        
        .region-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .region-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }
        
        .region-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
        }
        
        .opportunity-count {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
        }
        
        /* Evaluaci√≥n de Factibilidad */
        .feasibility-meter {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
        }
        
        .meter-container {
            margin: 20px 0;
        }
        
        .meter-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .meter-bar {
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }
        
        .meter-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            transition: width 1s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            color: white;
            font-weight: 600;
        }
        
        /* Sistema de Metas */
        .goals-system {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
        }
        
        .goal-item {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .goal-checkbox {
            width: 25px;
            height: 25px;
            border: 2px solid #667eea;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .goal-checkbox.checked {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .goal-text {
            flex: 1;
            font-size: 1.1rem;
        }
        
        .goal-deadline {
            background: #e9ecef;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            color: #666;
        }
        
        /* Recursos y Enlaces */
        .resources-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
        }
        
        .resource-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .resource-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .resource-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            border-color: #667eea;
        }
        
        .resource-icon {
            font-size: 2rem;
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .resource-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
        }
        
        .resource-description {
            color: #666;
            margin-bottom: 15px;
        }
        
        .resource-link {
            color: #667eea;
            text-decoration: none;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        
        .resource-link:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <!-- Cargador -->
    <div class="loader" id="loader">
        <div class="loader-circle"></div>
    </div>
    
    <!-- Part√≠culas flotantes -->
    <div class="particles" id="particles"></div>
    
    <!-- Toggle de sonido -->
    <div class="sound-toggle" onclick="toggleSound()" title="Activar/Desactivar sonidos">
        <span id="soundIcon">üîä</span>
    </div>
    
    <!-- Notificaci√≥n de logros -->
    <div class="achievement" id="achievement">
        <span class="achievement-icon">üèÜ</span>
        <span class="achievement-text" id="achievementText">¬°Logro desbloqueado!</span>
    </div>

    <!-- Asistente Virtual -->
    <div class="chat-assistant" id="chatAssistant" style="display: none;">
        <button class="chat-button" onclick="toggleChat()">
            <i class="fas fa-robot"></i>
        </button>
        <div class="chat-window" id="chatWindow">
            <div class="chat-header">
                <span>ü§ñ Asistente Vocacional</span>
                <button onclick="toggleChat()" style="background: none; border: none; color: white; cursor: pointer;">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="chat-messages" id="chatMessages">
                <div class="chat-message">
                    <div class="message-bubble">
                        ¬°Hola! Soy tu asistente vocacional. Estoy aqu√≠ para ayudarte a interpretar tus resultados y responder todas tus dudas. ¬øEn qu√© puedo ayudarte?
                    </div>
                </div>
            </div>
            <div class="chat-input">
                <input type="text" id="chatInput" placeholder="Escribe tu pregunta..." onkeypress="handleChatKeyPress(event)">
                <button onclick="sendMessage()">Enviar</button>
            </div>
        </div>
    </div>

    <div class="container">
        <header>
            <h1>üß† CASM-83 2.0 IA</h1>
            <p style="color: white; font-size: 1.2rem; margin-top: 10px;">Test Vocacional con Inteligencia Artificial Integrada</p>
        </header>

        <!-- Formulario de datos -->
        <div class="card" id="formCard">
            <h2 style="text-align: center; margin-bottom: 30px; color: #667eea;">üìã Datos del Evaluado</h2>
            <form id="userForm">
                <div class="form-group">
                    <label>üë§ Nombres y Apellidos *</label>
                    <input type="text" id="nombre" class="form-control" required placeholder="Escribe tu nombre completo">
                </div>
                <div class="form-group">
                    <label>üéÇ Edad *</label>
                    <input type="number" id="edad" class="form-control" min="12" max="30" required placeholder="Ej: 16">
                </div>
                <div class="form-group">
                    <label>‚ö• Sexo *</label>
                    <select id="sexo" class="form-control" required>
                        <option value="">Seleccione</option>
                        <option value="M">Masculino</option>
                        <option value="F">Femenino</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>üè´ Instituci√≥n Educativa *</label>
                    <div class="autocomplete">
                        <input type="text" id="colegio" class="form-control" required placeholder="Escribe para buscar tu instituci√≥n">
                    </div>
                </div>
                <div class="form-group">
                    <label>üéì Tipo de Instituci√≥n *</label>
                    <select id="tipoInstitucion" class="form-control" required onchange="actualizarNiveles()">
                        <option value="">Seleccione</option>
                        <option value="colegio">Colegio</option>
                        <option value="instituto">Instituto</option>
                        <option value="universidad">Universidad</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>üìö Nivel de Estudio *</label>
                    <select id="nivel" class="form-control" required>
                        <option value="">Seleccione primero el tipo de instituci√≥n</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">üöÄ Iniciar Evaluaci√≥n</button>
            </form>
        </div>

        <!-- Test de preguntas -->
        <div class="card hidden" id="testCard">
            <div class="progress-container">
                <div class="progress-circle">
                    <svg width="150" height="150">
                        <defs>
                            <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        <circle class="progress-bg" cx="75" cy="75" r="65"></circle>
                        <circle class="progress-bar" id="progressCircle" cx="75" cy="75" r="65" 
                                stroke-dasharray="408.4" stroke-dashoffset="408.4"></circle>
                    </svg>
                    <div class="progress-text" id="progressText">0%</div>
                </div>
                <div id="timeAlert"></div>
            </div>
            
            <div id="questionContainer"></div>
            
            <div class="nav-buttons">
                <button class="btn" id="prevBtn">‚¨ÖÔ∏è Anterior</button>
                <button class="btn" id="skipBtn">‚è≠Ô∏è Omitir</button>
                <button class="btn btn-primary" id="nextBtn">Siguiente ‚û°Ô∏è</button>
            </div>
        </div>

        <!-- Resultados -->
        <div class="card hidden" id="resultsCard">
            <h2 style="text-align: center; margin-bottom: 20px; color: #667eea;">üéä Informe Psicol√≥gico Vocacional con IA</h2>
            <div id="userInfo" style="text-align: center; margin-bottom: 20px;"></div>
            <div id="validityInfo"></div>
            <div id="contradictionsAlert"></div>
            
            <!-- Pesta√±as de gr√°ficos -->
            <div class="chart-tabs">
                <div class="chart-tab active" onclick="switchChart('radar')">Gr√°fico Radar</div>
                <div class="chart-tab" onclick="switchChart('percentile')">Percentiles</div>
                <div class="chart-tab" onclick="switchChart('comparison')">Comparaci√≥n</div>
            </div>
            
            <!-- Contenedor de gr√°ficos -->
            <div class="chart-container">
                <canvas id="chart"></canvas>
            </div>
            
            <div id="psychReport"></div>
            <div id="areasGrid" class="area-grid"></div>
            <div id="careersSection"></div>
            
            <!-- Plan de Acci√≥n Personalizado -->
            <button class="collapsible" id="planBtn">üìã Ver Plan de Acci√≥n Personalizado</button>
            <div class="content" id="planContent">
                <div id="actionPlan"></div>
            </div>
            
            <!-- Simulador de Carreras -->
            <button class="collapsible" id="simulatorBtn">üéÆ Simulador de Carreras Interactivo</button>
            <div class="content" id="simulatorContent">
                <div id="careerSimulator"></div>
            </div>
            
            <!-- Mapa de Oportunidades -->
            <button class="collapsible" id="mapBtn">üó∫Ô∏è Mapa de Oportunidades Laborales</button>
            <div class="content" id="mapContent">
                <div id="opportunityMap"></div>
            </div>
            
            <!-- Evaluaci√≥n de Factibilidad -->
            <button class="collapsible" id="feasibilityBtn">üìä Evaluaci√≥n de Factibilidad</button>
            <div class="content" id="feasibilityContent">
                <div id="feasibilityMeter"></div>
            </div>
            
            <!-- Sistema de Metas -->
            <button class="collapsible" id="goalsBtn">üéØ Sistema de Metas Vocacionales</button>
            <div class="content" id="goalsContent">
                <div id="goalsSystem"></div>
            </button>
            
            <!-- Recursos y Enlaces -->
            <button class="collapsible" id="resourcesBtn">üìö Recursos y Becas Disponibles</button>
            <div class="content" id="resourcesContent">
                <div id="resourcesSection"></div>
            </div>
            
            <!-- Secci√≥n de empresas con bot√≥n -->
            <button class="collapsible" id="companiesBtn">üè¢ Ver Empresas y Organizaciones de Referencia</button>
            <div class="content" id="companiesContent">
                <div id="companiesSection"></div>
            </div>
            
            <div style="text-align: center; margin-top: 30px; display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                <button class="btn btn-primary" onclick="window.print()">üìÑ Imprimir Informe</button>
                <button class="btn" onclick="location.reload()">üîÑ Nueva Evaluaci√≥n</button>
                <button class="btn" onclick="shareResults()">üì§ Compartir Resultados</button>
                <button class="btn btn-success" onclick="downloadPDF()">üì• Descargar PDF</button>
            </div>
        </div>
    </div>

    <script>
        // Lista de instituciones de Hu√°nuco
        const institucionesHuanuco = [
            "Universidad Nacional Hermilio Valdiz√°n (UNHEVAL)",
            "Universidad de Hu√°nuco (UDH)",
            "Universidad C√©sar Vallejo - Filial Hu√°nuco",
            "Universidad Nacional Agraria de la Selva (UNAS)",
            "Universidad Peruana Los Andes - Hu√°nuco",
            "Universidad Cat√≥lica Los √Ångeles de Chimbote (ULADECH) - Hu√°nuco",
            "SENATI Hu√°nuco",
            "Instituto Tecnol√≥gico P√∫blico Aparicio Pomares",
            "Instituto Barton School",
            "Instituto Amauta",
            "Instituto Superior Tecnol√≥gico Privado Se√±or de Burgos",
            "Instituto Superior Pedag√≥gico Privado Esteban Pavletich",
            "Instituto Continental - Hu√°nuco",
            "Instituto Superior Tecnol√≥gico Hu√°nuco",
            "Instituto Superior Tecnol√≥gico Daniel Alcides Carri√≥n",
            "Instituto Continental del Centro",
            "Colegio El Gran Maestro Pitumama",
            "Colegio Nacional Mariscal C√°ceres",
            "Colegio Nacional Leoncio Prado",
            "Colegio La Divina Misericordia",
            "Colegio San Pablo de Hu√°nuco",
            "Colegio Excelencia San Vicente de La Barquera",
            "Colegio Ingenier√≠a",
            "Colegio Honores",
            "Colegio Galileo Galilei",
            "Colegio San Luis Gonzaga",
            "Colegio Mercedes Cabello de Carbonera",
            "Colegio Julio Armando Luis V√°squez",
            "Colegio Juan Velasco Alvarado",
            "Colegio Virgen del Carmen",
            "Colegio Cristo Salvador",
            "Colegio Nuestra Se√±ora de Las Mercedes",
            "Colegio San Pedro",
            "Colegio Santa Rosa de Lima",
            "Colegio San Mart√≠n de Porres",
            "Colegio Pit√°goras Hu√°nuco",
            "Colegio Nuevo Mundo",
            "Colegio Hu√°nuco",
            "Colegio Los Andes",
            "Colegio La Inmaculada",
            "Colegio Amauta",
            "Colegio San Francisco de As√≠s",
            "Colegio San Juan Bosco",
            "Colegio Santa Mar√≠a Goretti",
            "Colegio Santa Isabel",
            "Colegio Se√±or de Burgos",
            "Colegio Jos√© Carlos Mari√°tegui",
            "Colegio Francisco Bolognesi",
            "Colegio El Shaddai",
            "Colegio Mar√≠a Montessori",
            "Colegio Lord Kelvin",
            "Colegio Humboldt",
            "Colegio San Marcos",
            "Colegio Andr√©s Avelino C√°ceres",
            "Colegio Huallaga",
            "Colegio Los Libertadores",
            "Colegio Nuevo Saber",
            "Colegio Santa Clara",
            "Colegio Adventista de Hu√°nuco"
        ];

        // Niveles educativos por tipo de instituci√≥n
        const nivelesEducativos = {
            colegio: ["1er Grado", "2do Grado", "3er Grado", "4to Grado", "5to Grado", "6to Grado", "1er A√±o Secundaria", "2do A√±o Secundaria", "3er A√±o Secundaria", "4to A√±o Secundaria", "5to A√±o Secundaria"],
            instituto: ["1er Ciclo", "2do Ciclo", "3er Ciclo", "4to Ciclo", "5to Ciclo", "Egresado"],
            universidad: ["1er A√±o", "2do A√±o", "3er A√±o", "4to A√±o", "5to A√±o", "6to A√±o", "Egresado"]
        };

        // Empresas peruanas por √°rea vocacional
        const empresasPorArea = {
            CCFM: [
                {name: "GMD", icon: "üîß", sector: "Ingenier√≠a y Construcci√≥n"},
                {name: "Gra√±a y Montero", icon: "üèóÔ∏è", sector: "Ingenier√≠a y Construcci√≥n"},
                {name: "AJE Group", icon: "ü•§", sector: "Bebidas y Tecnolog√≠a"},
                {name: "Rimac Seguros", icon: "üõ°Ô∏è", sector: "Tecnolog√≠a y Seguros"},
                {name: "Banco de la Naci√≥n", icon: "üè¶", sector: "Tecnolog√≠a Financiera"}
            ],
            CCSS: [
                {name: "Ministerio de Educaci√≥n", icon: "üìö", sector: "Educaci√≥n P√∫blica"},
                {name: "UNICEF Per√∫", icon: "üë∂", sector: "Organizaci√≥n Humanitaria"},
                {name: "Cruz Roja Peruana", icon: "‚öïÔ∏è", sector: "Salud Social"},
                {name: "CARITAS Per√∫", icon: "‚ù§Ô∏è", sector: "Ayuda Social"},
                {name: "PUCP", icon: "üéì", sector: "Educaci√≥n Superior"}
            ],
            CCNA: [
                {name: "SERPAR", icon: "üå≥", sector: "Servicios de Parques"},
                {name: "Ministerio del Ambiente", icon: "üåø", sector: "Medio Ambiente"},
                {name: "SERNANP", icon: "ü¶ú", sector: "√Åreas Naturales Protegidas"},
                {name: "ANA", icon: "üíß", sector: "Recursos H√≠dricos"},
                {name: "Inrena", icon: "üèûÔ∏è", sector: "Recursos Naturales"}
            ],
            ARTE: [
                {name: "TV Per√∫", icon: "üì∫", sector: "Producci√≥n Audiovisual"},
                {name: "El Comercio", icon: "üì∞", sector: "Medios de Comunicaci√≥n"},
                {name: "Museo Larco", icon: "üè∫", sector: "Arte y Cultura"},
                {name: "Teatro Nacional", icon: "üé≠", sector: "Artes Esc√©nicas"},
                {name: "PUCP - Arte", icon: "üé®", sector: "Educaci√≥n Art√≠stica"}
            ],
            LING: [
                {name: "El Comercio", icon: "üì∞", sector: "Periodismo"},
                {name: "RPP", icon: "üìª", sector: "Radio y Comunicaci√≥n"},
                {name: "Am√©rica Televisi√≥n", icon: "üì∫", sector: "Televisi√≥n"},
                {name: "Editorial Santillana", icon: "üìñ", sector: "Editorial"},
                {name: "Ministerio de Cultura", icon: "üìö", sector: "Cultura y Comunicaci√≥n"}
            ],
            BURO: [
                {name: "BCP", icon: "üí≥", sector: "Banca"},
                {name: "BBVA Continental", icon: "üè¶", sector: "Banca"},
                {name: "Interbank", icon: "üí∞", sector: "Banca"},
                {name: "Falabella", icon: "üõí", sector: "Retail"},
                {name: "Inka Farms", icon: "ü•ë", sector: "Agroindustria"}
            ],
            CCEP: [
                {name: "Banco Central de Reserva", icon: "üíµ", sector: "Banca Central"},
                {name: "Superintendencia de Banca", icon: "üèõÔ∏è", sector: "Regulaci√≥n Financiera"},
                {name: "Congreso de la Rep√∫blica", icon: "üèõÔ∏è", sector: "Pol√≠tica"},
                {name: "Poder Judicial", icon: "‚öñÔ∏è", sector: "Sistema Judicial"},
                {name: "Estudio Mu√±iz", icon: "üëî", sector: "Estudio Jur√≠dico"}
            ],
            MEDI: [
                {name: "EsSalud", icon: "üè•", sector: "Salud P√∫blica"},
                {name: "Cl√≠nica Anglo Americana", icon: "üè•", sector: "Salud Privada"},
                {name: "MINSA", icon: "üè•", sector: "Salud P√∫blica"},
                {name: "Instituto Nacional de Salud", icon: "üî¨", sector: "Investigaci√≥n M√©dica"},
                {name: "UPCH", icon: "üéì", sector: "Educaci√≥n M√©dica"}
            ]
        };

        // Base de datos de carreras con informaci√≥n detallada
        const carrerasDB = {
            "Ingenier√≠a de Sistemas": {
                area: "CCFM",
                duracion: "5 a√±os",
                salario: "S/ 3,500 - S/ 8,000",
                demanda: "Alta",
                habilidades: ["L√≥gica matem√°tica", "Programaci√≥n", "Resoluci√≥n de problemas", "Trabajo en equipo"],
                universidades: ["UNI", "PUCP", "UNHEVAL", "UPC", "UTP"],
                descripcion: "Dise√±o, desarrollo y mantenimiento de sistemas inform√°ticos y software."
            },
            "Medicina": {
                area: "MEDI",
                duracion: "7 a√±os",
                salario: "S/ 4,000 - S/ 15,000",
                demanda: "Muy Alta",
                habilidades: ["Ciencias biol√≥gicas", "Empat√≠a", "Resistencia al estr√©s", "Comunicaci√≥n"],
                universidades: ["UNMSM", "UPCH", "UNHEVAL", "UCSM", "USIL"],
                descripcion: "Diagn√≥stico, tratamiento y prevenci√≥n de enfermedades humanas."
            },
            "Psicolog√≠a": {
                area: "CCSS",
                duracion: "5 a√±os",
                salario: "S/ 2,000 - S/ 6,000",
                demanda: "Media",
                habilidades: ["Escucha activa", "An√°lisis", "Empat√≠a", "Paciencia"],
                universidades: ["PUCP", "UNMSM", "UNHEVAL", "UPN", "USIL"],
                descripcion: "Estudio del comportamiento humano y procesos mentales."
            },
            "Derecho": {
                area: "CCEP",
                duracion: "5 a√±os",
                salario: "S/ 2,500 - S/ 10,000",
                demanda: "Alta",
                habilidades: ["Argumentaci√≥n", "An√°lisis cr√≠tico", "Investigaci√≥n", "Oratoria"],
                universidades: ["PUCP", "UNMSM", "UNHEVAL", "UPC", "ULADECH"],
                descripcion: "Estudio y aplicaci√≥n de las leyes y normas jur√≠dicas."
            },
            "Administraci√≥n": {
                area: "BURO",
                duracion: "5 a√±os",
                salario: "S/ 2,500 - S/ 7,000",
                demanda: "Alta",
                habilidades: ["Liderazgo", "Planificaci√≥n", "Negociaci√≥n", "An√°lisis financiero"],
                universidades: ["PUCP", "UNMSM", "UNHEVAL", "UPC", "ESAN"],
                descripcion: "Gesti√≥n y direcci√≥n de organizaciones y empresas."
            },
            "Arquitectura": {
                area: "CCFM",
                duracion: "6 a√±os",
                salario: "S/ 3,000 - S/ 8,000",
                demanda: "Media",
                habilidades: ["Dise√±o", "Creatividad", "Dibujo t√©cnico", "Visi√≥n espacial"],
                universidades: ["UNI", "PUCP", "UNHEVAL", "UPC", "UTP"],
                descripcion: "Dise√±o y construcci√≥n de espacios y edificaciones."
            },
            "Contabilidad": {
                area: "BURO",
                duracion: "5 a√±os",
                salario: "S/ 2,000 - S/ 6,000",
                demanda: "Alta",
                habilidades: ["An√°lisis num√©rico", "Atenci√≥n al detalle", "√âtica", "Organizaci√≥n"],
                universidades: ["UNMSM", "PUCP", "UNHEVAL", "UPC", "ULADECH"],
                descripcion: "Registro y control de operaciones financieras y tributarias."
            },
            "Enfermer√≠a": {
                area: "MEDI",
                duracion: "5 a√±os",
                salario: "S/ 1,800 - S/ 4,500",
                demanda: "Muy Alta",
                habilidades: ["Cuidado humano", "Resistencia", "Empat√≠a", "Trabajo bajo presi√≥n"],
                universidades: ["UNMSM", "UPCH", "UNHEVAL", "USIL", "ULADECH"],
                descripcion: "Cuidado integral de la salud de las personas."
            }
        };

        // 20 preguntas de prueba con pares contradictorios
        const questions = [
            {id: 1, a: "Resolver problemas matem√°ticos complejos", b: "Dise√±ar edificios y estructuras", aA: "CCFM", aB: "CCFM", pair: null},
            {id: 2, a: "Escribir cuentos o poes√≠as", b: "Realizar experimentos cient√≠ficos", aA: "LING", aB: "CCNA", pair: null},
            {id: 3, a: "Dibujar o pintar obras art√≠sticas", b: "Organizar eventos sociales", aA: "ARTE", aB: "CCSS", pair: null},
            {id: 4, a: "Estudiar comportamiento humano", b: "Aprender idiomas extranjeros", aA: "CCSS", aB: "LING", pair: null},
            {id: 5, a: "Programar computadoras", b: "Cuidar y tratar animales", aA: "CCFM", aB: "CCNA", pair: 15},
            {id: 6, a: "Tocar un instrumento musical", b: "Defender causas legales en tribunales", aA: "ARTE", aB: "CCEP", pair: null},
            {id: 7, a: "Ense√±ar a otros estudiantes", b: "Administrar una empresa", aA: "CCSS", aB: "BURO", pair: 17},
            {id: 8, a: "Trabajar en campo abierto", b: "Atender pacientes en hospital", aA: "CCNA", aB: "MEDI", pair: null},
            {id: 9, a: "Escribir art√≠culos period√≠sticos", b: "Hacer c√°lculos contables", aA: "LING", aB: "BURO", pair: null},
            {id: 10, a: "Investigar plantas y ecosistemas", b: "Reparar m√°quinas y motores", aA: "CCNA", aB: "CCFM", pair: null},
            {id: 11, a: "Analizar datos estad√≠sticos", b: "Componer m√∫sica original", aA: "CCFM", aB: "ARTE", pair: null},
            {id: 12, a: "Dar terapia psicol√≥gica", b: "Dirigir obras de teatro", aA: "CCSS", aB: "ARTE", pair: null},
            {id: 13, a: "Estudiar leyes y c√≥digos", b: "Gestionar recursos humanos", aA: "CCEP", aB: "BURO", pair: null},
            {id: 14, a: "Realizar cirug√≠as", b: "Investigar nuevos medicamentos", aA: "MEDI", aB: "CCNA", pair: null},
            {id: 15, a: "Trabajar con tecnolog√≠a y software", b: "Estudiar vida animal salvaje", aA: "CCFM", aB: "CCNA", pair: 5},
            {id: 16, a: "Traducir textos literarios", b: "Crear campa√±as publicitarias", aA: "LING", aB: "BURO", pair: null},
            {id: 17, a: "Orientar vocacionalmente", b: "Dirigir equipos empresariales", aA: "CCSS", aB: "BURO", pair: 7},
            {id: 18, a: "Pintar murales urbanos", b: "Analizar mercados financieros", aA: "ARTE", aB: "CCEP", pair: null},
            {id: 19, a: "Formular proyectos de construcci√≥n", b: "Investigar f√≠sica cu√°ntica", aA: "CCFM", aB: "CCFM", pair: null},
            {id: 20, a: "Atenci√≥n pre-hospitalaria", b: "Realizar autopsias forenses", aA: "MEDI", aB: "MEDI", pair: null}
        ];

        const areas = {
            CCFM: {
                name: "Ciencias F√≠sico-Matem√°ticas", 
                icon: "üî¨", 
                color: "#667eea",
                description: "Inter√©s por el an√°lisis l√≥gico, matem√°ticas, f√≠sica y tecnolog√≠a",
                carreras: ["Ingenier√≠a Civil", "Ingenier√≠a de Sistemas", "F√≠sica", "Matem√°ticas", "Arquitectura"],
                perfil: "Anal√≠tico, met√≥dico, curioso, resolutivo, orientado a la precisi√≥n y la eficiencia"
            },
            CCSS: {
                name: "Ciencias Sociales", 
                icon: "üë•", 
                color: "#4ECDC4",
                description: "Inter√©s por las relaciones humanas, educaci√≥n y desarrollo social",
                carreras: ["Psicolog√≠a", "Sociolog√≠a", "Trabajo Social", "Educaci√≥n", "Antropolog√≠a"],
                perfil: "Emp√°tico, comunicativo, observador, solidario, orientado a ayudar a otros"
            },
            CCNA: {
                name: "Ciencias Naturales", 
                icon: "üåø", 
                color: "#06D6A0",
                description: "Inter√©s por la vida, naturaleza, ecolog√≠a y medio ambiente",
                carreras: ["Biolog√≠a", "Veterinaria", "Ing. Ambiental", "Agronom√≠a", "Ecolog√≠a"],
                perfil: "Curioso, paciente, observador, respetuoso con la vida, orientado a la investigaci√≥n"
            },
            ARTE: {
                name: "Arte y Creatividad", 
                icon: "üé®", 
                color: "#FF6584",
                description: "Inter√©s por la expresi√≥n art√≠stica, dise√±o y creaci√≥n est√©tica",
                carreras: ["Bellas Artes", "Dise√±o Gr√°fico", "M√∫sica", "Artes Esc√©nicas", "Fotograf√≠a"],
                perfil: "Creativo, expresivo, sensible, original, orientado a la est√©tica y la innovaci√≥n"
            },
            LING: {
                name: "Ling√º√≠stica", 
                icon: "üìö", 
                color: "#A569BD",
                description: "Inter√©s por lenguaje, comunicaci√≥n escrita y expresi√≥n verbal",
                carreras: ["Literatura", "Traducci√≥n", "Periodismo", "Comunicaci√≥n", "Idiomas"],
                perfil: "Comunicativo, anal√≠tico, curioso, expresivo, orientado a la informaci√≥n y el conocimiento"
            },
            BURO: {
                name: "Administrativo", 
                icon: "üìã", 
                color: "#5DADE2",
                description: "Inter√©s por organizaci√≥n, gesti√≥n y procesos administrativos",
                carreras: ["Administraci√≥n", "Contabilidad", "RR.HH.", "Marketing", "Negocios"],
                perfil: "Organizado, planificador, eficiente, pragm√°tico, orientado a resultados y metas"
            },
            CCEP: {
                name: "Econ√≥mico-Legal", 
                icon: "üí∞", 
                color: "#F39C12",
                description: "Inter√©s por leyes, econom√≠a y sistemas pol√≠ticos",
                carreras: ["Derecho", "Econom√≠a", "Ciencias Pol√≠ticas", "Finanzas", "Auditor√≠a"],
                perfil: "Anal√≠tico, argumentativo, justo, estrat√©gico, orientado a la justicia y la equidad"
            },
            MEDI: {
                name: "Ciencias de la Salud", 
                icon: "‚öïÔ∏è", 
                color: "#E74C3C",
                description: "Inter√©s por salud humana, medicina y cuidado de personas",
                carreras: ["Medicina", "Enfermer√≠a", "Odontolog√≠a", "Nutrici√≥n", "Farmacia"],
                perfil: "Solidario, responsable, meticuloso, compasivo, orientado al cuidado y bienestar"
            }
        };

        // Baremos percentiles por edad y sexo
        const baremos = {
            "M_3ro": {CCFM: 14, CCSS: 12, CCNA: 11, ARTE: 9, LING: 10, BURO: 13, CCEP: 12, MEDI: 11},
            "M_4to": {CCFM: 15, CCSS: 13, CCNA: 12, ARTE: 10, LING: 11, BURO: 14, CCEP: 13, MEDI: 12},
            "M_5to": {CCFM: 16, CCSS: 14, CCNA: 13, ARTE: 11, LING: 12, BURO: 15, CCEP: 14, MEDI: 13},
            "F_3ro": {CCFM: 12, CCSS: 15, CCNA: 13, ARTE: 14, LING: 15, BURO: 13, CCEP: 11, MEDI: 14},
            "F_4to": {CCFM: 13, CCSS: 16, CCNA: 14, ARTE: 15, LING: 16, BURO: 14, CCEP: 12, MEDI: 15},
            "F_5to": {CCFM: 14, CCSS: 17, CCNA: 15, ARTE: 16, LING: 17, BURO: 15, CCEP: 13, MEDI: 16}
        };

        // Interpretaciones psicol√≥gicas predefinidas seg√∫n perfiles
        const interpretacionesPsicologicas = {
            definido: {
                titulo: "PERFIL VOCACIONAL DEFINIDO",
                descripcion: "Tus intereses muestran una clara direcci√≥n hacia un √°rea espec√≠fica. Esta definici√≥n indica que has desarrollado una preferencia s√≥lida que puede guiarte eficazmente en tu elecci√≥n profesional.",
                recomendaciones: [
                    "Profundiza en el conocimiento del √°rea de tu inter√©s a trav√©s de experiencias pr√°cticas",
                    "Busca mentores o profesionales que trabajen en este campo",
                    "Considera especializaciones dentro de esta √°rea que se alineen con tus habilidades espec√≠ficas",
                    "Mant√©n un equilibrio explorando √°reas secundarias que complementen tu principal inter√©s"
                ]
            },
            multipotencial: {
                titulo: "PERFIL MULTIPOTENCIAL",
                descripcion: "Presentas intereses diversos en m√∫ltiples √°reas, lo que indica versatilidad y capacidad para adaptarte a diferentes campos profesionales. Este perfil es valioso en un mundo laboral que requiere habilidades interdisciplinarias.",
                recomendaciones: [
                    "Explora carreras que combinen tus √°reas de mayor inter√©s",
                    "Considera estudios interdisciplinarios o dobles titulaciones",
                    "Desarrolla proyectos personales que integren tus diferentes intereses",
                    "Prioriza seg√∫n tus habilidades y valores personales, no solo intereses"
                ]
            },
            emergente: {
                titulo: "PERFIL EN EMERGENCIA",
                descripcion: "Tus intereses est√°n en proceso de desarrollo, lo cual es completamente normal en tu etapa educativa. Esta es una fase de exploraci√≥n donde descubrir√°s gradualmente tus preferencias.",
                recomendaciones: [
                    "Participa en actividades extracurriculares variadas para descubrir nuevos intereses",
                    "Habla con profesionales de diferentes campos para conocer sus experiencias",
                    "No te presiones por definir tu futuro inmediatamente, la exploraci√≥n es valiosa",
                    "Desarrolla habilidades transversales (comunicaci√≥n, pensamiento cr√≠tico) aplicables a cualquier √°rea"
                ]
            },
            disperso: {
                titulo: "PERFIL EN EXPLORACI√ìN",
                descripcion: "Tus intereses a√∫n no muestran una direcci√≥n clara, lo que indica que est√°s en una fase inicial de descubrimiento vocacional. Esta etapa es ideal para experimentar sin compromisos.",
                recomendaciones: [
                    "Realiza voluntariados o pasant√≠as cortas en diferentes √°reas",
                    "Asiste a charlas, ferias vocacionales y jornadas de puertas abiertas",
                    "Desarrolla un portafolio de proyectos en diferentes √°reas para identificar patrones",
                    "Considera pruebas de aptitudes que complementen este an√°lisis de intereses"
                ]
            }
        };

        // Respuestas del asistente virtual
        const respuestasAsistente = {
            "saludo": ["¬°Hola! Estoy aqu√≠ para ayudarte.", "¬°Hola! ¬øEn qu√© puedo asistirte hoy?", "¬°Hola! Encantado de ayudarte con tus resultados."],
            "perfil": ["Seg√∫n tus resultados, tu perfil vocacional indica...", "Tu perfil muestra una clara inclinaci√≥n hacia...", "Los resultados revelan que tienes un perfil..."],
            "carrera": ["Para esa carrera, te recomiendo...", "Esa carrera es excelente para tu perfil porque...", "Considera que esa carrera requiere..."],
            "siguiente": ["El siguiente paso ser√≠a...", "Te sugiero que ahora...", "Lo m√°s importante ahora es..."],
            "duda": ["Entiendo tu duda. Perm√≠teme explicarte...", "Es una excelente pregunta. Lo que debes saber es...", "Mucha gente tiene esa misma duda. La respuesta es..."],
            "default": ["Interesante pregunta. D√©jame pensar...", "Eso es muy importante para tu decisi√≥n.", "Gracias por preguntar. Considera que..."]
        };

        let currentQ = 0, answers = [], userData = {}, times = [], start = Date.now();
        let soundEnabled = true;
        let contradictions = [];
        let autoResponsePattern = 0;
        let sameOptionStreak = 0;
        let lastOption = null;
        let currentChart = null;
        let currentChartType = 'radar';
        let achievements = [];
        let testResults = {};

        // Generar part√≠culas
        function createParticles() {
            const particles = document.getElementById('particles');
            for(let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 5 + 's';
                particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
                const colors = ['#fff', '#ffd700', '#ff6b6b', '#4ecdc4', '#a569bd'];
                particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                particles.appendChild(particle);
            }
        }
        createParticles();

        // Actualizar niveles seg√∫n tipo de instituci√≥n
        function actualizarNiveles() {
            const tipoInstitucion = document.getElementById('tipoInstitucion').value;
            const nivelSelect = document.getElementById('nivel');
            
            // Limpiar opciones actuales
            nivelSelect.innerHTML = '<option value="">Seleccione</option>';
            
            if (tipoInstitucion && nivelesEducativos[tipoInstitucion]) {
                nivelesEducativos[tipoInstitucion].forEach(nivel => {
                    const option = document.createElement('option');
                    option.value = nivel;
                    option.textContent = nivel;
                    nivelSelect.appendChild(option);
                });
            }
        }

        // Autocompletado para instituciones
        function autocomplete(inp, arr) {
            let currentFocus;
            
            inp.addEventListener("input", function(e) {
                let a, b, i, val = this.value;
                closeAllLists();
                if (!val) { return false;}
                currentFocus = -1;
                
                a = document.createElement("DIV");
                a.setAttribute("class", "autocomplete-items");
                a.setAttribute("id", this.id + "autocomplete-list");
                this.parentNode.appendChild(a);
                
                const filteredArr = arr.filter(item => 
                    item.toUpperCase().includes(val.toUpperCase())
                ).slice(0, 5); // Limitar a 5 resultados
                
                for (i = 0; i < filteredArr.length; i++) {
                    b = document.createElement("DIV");
                    
                    // Resaltar la parte coincidente
                    const regex = new RegExp(`(${val})`, "gi");
                    const highlightedText = filteredArr[i].replace(regex, "<strong>$1</strong>");
                    
                    b.innerHTML = highlightedText;
                    b.innerHTML += "<input type='hidden' value='" + filteredArr[i] + "'>";
                    b.addEventListener("click", function(e) {
                        inp.value = this.getElementsByTagName("input")[0].value;
                        closeAllLists();
                    });
                    a.appendChild(b);
                }
            });
            
            inp.addEventListener("keydown", function(e) {
                let x = document.getElementById(this.id + "autocomplete-list");
                if (x) x = x.getElementsByTagName("div");
                if (e.keyCode == 40) {
                    currentFocus++;
                    addActive(x);
                } else if (e.keyCode == 38) {
                    currentFocus--;
                    addActive(x);
                } else if (e.keyCode == 13) {
                    e.preventDefault();
                    if (currentFocus > -1) {
                        if (x) x[currentFocus].click();
                    }
                }
            });
            
            function addActive(x) {
                if (!x) return false;
                removeActive(x);
                if (currentFocus >= x.length) currentFocus = 0;
                if (currentFocus < 0) currentFocus = (x.length - 1);
                x[currentFocus].classList.add("autocomplete-active");
            }
            
            function removeActive(x) {
                for (let i = 0; i < x.length; i++) {
                    x[i].classList.remove("autocomplete-active");
                }
            }
            
            function closeAllLists(elmnt) {
                let x = document.getElementsByClassName("autocomplete-items");
                for (let i = 0; i < x.length; i++) {
                    if (elmnt != x[i] && elmnt != inp) {
                        x[i].parentNode.removeChild(x[i]);
                    }
                }
            }
            
            document.addEventListener("click", function (e) {
                closeAllLists(e.target);
            });
        }

        // Inicializar autocompletado
        setTimeout(() => {
            autocomplete(document.getElementById("colegio"), institucionesHuanuco);
        }, 100);

        // Sonidos (usando Web Audio API)
        function playSound(type) {
            if (!soundEnabled) return;
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            if (type === 'click') {
                oscillator.frequency.value = 800;
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.1);
            } else if (type === 'success') {
                oscillator.frequency.value = 1000;
                gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.3);
            } else if (type === 'achievement') {
                oscillator.frequency.value = 1200;
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            }
        }

        function toggleSound() {
            soundEnabled = !soundEnabled;
            document.getElementById('soundIcon').textContent = soundEnabled ? 'üîä' : 'üîá';
            playSound('click');
        }

        // Mostrar logros
        function showAchievement(text) {
            const achievementEl = document.getElementById('achievement');
            const achievementTextEl = document.getElementById('achievementText');
            
            achievementTextEl.textContent = text;
            achievementEl.classList.add('show');
            playSound('achievement');
            
            setTimeout(() => {
                achievementEl.classList.remove('show');
            }, 3000);
        }

        document.getElementById('userForm').onsubmit = (e) => {
            e.preventDefault();
            playSound('success');
            
            // Validar que la instituci√≥n est√© en la lista
            const colegioValue = document.getElementById('colegio').value;
            if (!institucionesHuanuco.includes(colegioValue)) {
                alert("Por favor, selecciona una instituci√≥n de la lista de sugerencias.");
                return;
            }
            
            userData = {
                nombre: document.getElementById('nombre').value,
                edad: document.getElementById('edad').value,
                sexo: document.getElementById('sexo').value,
                colegio: colegioValue,
                tipoInstitucion: document.getElementById('tipoInstitucion').value,
                nivel: document.getElementById('nivel').value
            };
            
            // Ocultar loader
            document.getElementById('loader').classList.add('hidden');
            
            document.getElementById('formCard').classList.add('hidden');
            document.getElementById('testCard').classList.remove('hidden');
            answers = new Array(20).fill(null);
            times = [];
            contradictions = [];
            showQuestion();
        };

        function showQuestion() {
            const q = questions[currentQ];
            const elapsed = (Date.now() - start) / 1000;
            
            // Alertas de tiempo
            let timeAlert = '';
            if (times.length > 0) {
                const lastTime = times[times.length - 1];
                if (lastTime < 2) {
                    timeAlert = '<div class="time-warning">‚ö° Respuesta muy r√°pida. T√≥mate tu tiempo para reflexionar.</div>';
                } else if (lastTime > 60) {
                    timeAlert = '<div class="time-warning">‚è∞ Respuesta lenta. Intenta mantener un ritmo constante.</div>';
                }
            }
            
            document.getElementById('timeAlert').innerHTML = timeAlert;
            
            document.getElementById('questionContainer').innerHTML = `
                <h3 style="color: #667eea; margin-bottom: 15px; font-size: 1.5rem;">
                    Pregunta ${q.id} de ${questions.length}
                </h3>
                <p style="margin-bottom: 20px; font-size: 1.1rem; color: #555;">
                    ¬øCu√°l de estas actividades te interesa m√°s?
                </p>
                <div class="options">
                    <div class="option ${answers[currentQ]==='a'?'selected':''}" onclick="selectOpt('a')">
                        <span class="option-icon">üÖ∞Ô∏è</span>
                        <div style="font-size: 1.1rem;">${q.a}</div>
                    </div>
                    <div class="option ${answers[currentQ]==='b'?'selected':''}" onclick="selectOpt('b')">
                        <span class="option-icon">üÖ±Ô∏è</span>
                        <div style="font-size: 1.1rem;">${q.b}</div>
                    </div>
                </div>
            `;
            
            updateProgress();
            document.getElementById('prevBtn').disabled = currentQ === 0;
            document.getElementById('nextBtn').textContent = currentQ === questions.length - 1 ? '‚úÖ Finalizar' : 'Siguiente ‚û°Ô∏è';
        }

        function updateProgress() {
            const pct = Math.round(((currentQ + 1) / questions.length) * 100);
            const circumference = 2 * Math.PI * 65;
            const offset = circumference - (pct / 100) * circumference;
            
            document.getElementById('progressCircle').style.strokeDashoffset = offset;
            document.getElementById('progressText').textContent = pct + '%';
            
            // Logros por progreso
            if (pct === 25 && !achievements.includes('quarter')) {
                achievements.push('quarter');
                showAchievement("üèÜ ¬°Has completado el 25% del test!");
            } else if (pct === 50 && !achievements.includes('half')) {
                achievements.push('half');
                showAchievement("üèÜ ¬°Mitad del test completada!");
            } else if (pct === 75 && !achievements.includes('threequarters')) {
                achievements.push('threequarters');
                showAchievement("üèÜ ¬°Casi terminando, 75% completado!");
            }
        }

        function selectOpt(opt) {
            playSound('click');
            const elapsed = (Date.now() - start) / 1000;
            times.push(elapsed);
            
            // Detecci√≥n de patrones
            if (elapsed < 1.5) {
                autoResponsePattern++;
            }
            
            // Detecci√≥n de respuestas repetitivas
            if (lastOption === opt) {
                sameOptionStreak++;
            } else {
                sameOptionStreak = 0;
            }
            lastOption = opt;
            
            // Guardar respuesta
            answers[currentQ] = opt;
            
            // Verificar contradicciones
            const q = questions[currentQ];
            if (q.pair !== null) {
                const pairIndex = questions.findIndex(x => x.id === q.pair);
                if (answers[pairIndex] !== null) {
                    // Si respondi√≥ lo mismo en ambas preguntas contradictorias
                    if (answers[currentQ] === answers[pairIndex]) {
                        contradictions.push({q1: currentQ + 1, q2: q.pair});
                    }
                }
            }
            
            showQuestion();
            start = Date.now();
        }

        document.getElementById('prevBtn').onclick = () => {
            if (currentQ > 0) {
                currentQ--;
                showQuestion();
                playSound('click');
            }
        };

        document.getElementById('nextBtn').onclick = () => {
            if (currentQ < questions.length - 1) {
                currentQ++;
                showQuestion();
                playSound('click');
            } else {
                finishTest();
            }
        };

        document.getElementById('skipBtn').onclick = () => {
            answers[currentQ] = null;
            playSound('click');
            document.getElementById('nextBtn').click();
        };

        function finishTest() {
            playSound('success');
            
            // Mostrar loader mientras se procesan los resultados
            document.getElementById('loader').classList.remove('hidden');
            
            // Simular procesamiento
            setTimeout(() => {
                // Calcular resultados por √°rea
                const results = {};
                Object.keys(areas).forEach(k => results[k] = 0);
                
                answers.forEach((ans, i) => {
                    if (ans && questions[i].aA) {
                        if (ans === 'a') results[questions[i].aA] += 2;
                        else results[questions[i].aB] += 2;
                    }
                });
                
                // Calcular validez
                const verac = Math.max(0, 100 - autoResponsePattern * 10 - sameOptionStreak * 5);
                const consist = Math.max(0, 100 - (answers.filter(a => a === null).length * 5) - (contradictions.length * 15));
                
                // Guardar resultados para uso posterior
                testResults = { results, verac, consist };
                
                // Ocultar loader
                document.getElementById('loader').classList.add('hidden');
                
                showResults(results, verac, consist);
                
                // Logro por completar el test
                if (!achievements.includes('completed')) {
                    achievements.push('completed');
                    showAchievement("üèÜ ¬°Test completado con √©xito!");
                }
                
                // Mostrar asistente virtual
                setTimeout(() => {
                    document.getElementById('chatAssistant').style.display = 'block';
                    addChatMessage("¬°Felicidades por completar el test! üéâ Estoy aqu√≠ para ayudarte a entender tus resultados. ¬øQu√© te gustar√≠a saber primero?", 'assistant');
                }, 2000);
            }, 1500);
        }

        function showResults(results, verac, consist) {
            document.getElementById('testCard').classList.add('hidden');
            document.getElementById('resultsCard').classList.remove('hidden');
            
            // Confeti
            createConfetti();
            
            // Informaci√≥n del usuario
            document.getElementById('userInfo').innerHTML = `
                <h3 style="font-size: 1.8rem; color: #667eea;">${userData.nombre}</h3>
                <p style="font-size: 1.1rem; color: #555;">${userData.edad} a√±os | ${userData.sexo === 'M' ? 'Masculino' : 'Femenino'}</p>
                <p style="font-size: 1rem; color: #777;">${userData.colegio} | ${userData.nivel}</p>
                <p style="color: #999; font-size: 0.9rem; margin-top: 10px;">Fecha: ${new Date().toLocaleDateString('es-PE', {year: 'numeric', month: 'long', day: 'numeric'})}</p>
            `;
            
            // Validez del test
            let vClass = 'alert-success', vText = 'V√ÅLIDO ‚úÖ', vIcon = '‚úÖ';
            if (verac < 70 || consist < 60) {
                vClass = 'alert-warning';
                vText = 'PRECAUCI√ìN ‚ö†Ô∏è';
                vIcon = '‚ö†Ô∏è';
            }
            if (verac < 50 || consist < 40) {
                vClass = 'alert-danger';
                vText = 'CUESTIONABLE ‚ùå';
                vIcon = '‚ùå';
            }
            
            document.getElementById('validityInfo').innerHTML = `
                <div class="alert ${vClass}">
                    <span class="alert-icon">${vIcon}</span>
                    <div style="flex: 1;">
                        <h3 style="margin-bottom: 10px;">Test ${vText}</h3>
                        <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                            <span>üìä Veracidad: <strong>${verac}%</strong></span>
                            <span>üéØ Consistencia: <strong>${consist}%</strong></span>
                            <span>‚ö° Respuestas r√°pidas: <strong>${autoResponsePattern}</strong></span>
                            <span>üîÅ Patr√≥n repetitivo: <strong>${sameOptionStreak > 3 ? 'S√≠' : 'No'}</strong></span>
                        </div>
                    </div>
                </div>
            `;
            
            // Alertas de contradicciones
            if (contradictions.length > 0) {
                let contradictHTML = `
                    <div class="alert alert-danger">
                        <span class="alert-icon">üòî</span>
                        <div style="flex: 1;">
                            <h3 style="margin-bottom: 10px;">Se encontraron ${contradictions.length} contradicci√≥n(es)</h3>
                            <p style="margin: 5px 0;">Las siguientes preguntas tienen respuestas inconsistentes:</p>
                            <ul style="margin-left: 20px; margin-top: 10px;">
                                ${contradictions.map(c => `<li>Pregunta ${c.q1} y Pregunta ${c.q2}</li>`).join('')}
                            </ul>
                            <p style="margin-top: 15px; font-weight: 600;">
                                üí° Recomendaci√≥n: Considera reiniciar el test y responder con m√°s reflexi√≥n.
                            </p>
                            <button class="btn btn-primary" onclick="location.reload()" style="margin-top: 15px; width: auto;">
                                üîÑ Reiniciar Test
                            </button>
                        </div>
                    </div>
                `;
                document.getElementById('contradictionsAlert').innerHTML = contradictHTML;
            }
            
            // Gr√°fico inicial (radar)
            createChart(results, 'radar');
            
            // Informe psicol√≥gico
            genPsychReport(results, verac, consist);
            
            // Tarjetas de √°reas
            genAreaCards(results);
            
            // Carreras recomendadas
            genCareers(results);
            
            // Plan de acci√≥n
            genActionPlan(results);
            
            // Simulador de carreras
            genCareerSimulator(results);
            
            // Mapa de oportunidades
            genOpportunityMap(results);
            
            // Evaluaci√≥n de factibilidad
            genFeasibilityMeter(results);
            
            // Sistema de metas
            genGoalsSystem(results);
            
            // Recursos
            genResourcesSection(results);
            
            // Empresas recomendadas (ocultas por defecto)
            genCompanies(results);
            
            // Configurar todos los botones collapsible
            setupAllCollapsibles();
        }

        function createConfetti() {
            for (let i = 0; i < 100; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.background = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#ffa502', '#a569bd', '#26de81'][Math.floor(Math.random() * 6)];
                    confetti.style.width = confetti.style.height = (Math.random() * 10 + 5) + 'px';
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => confetti.remove(), 3000);
                }, i * 30);
            }
        }

        function switchChart(type) {
            // Actualizar pesta√±as activas
            document.querySelectorAll('.chart-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Obtener resultados actuales
            const results = {};
            Object.keys(areas).forEach(k => results[k] = 0);
            
            answers.forEach((ans, i) => {
                if (ans && questions[i].aA) {
                    if (ans === 'a') results[questions[i].aA] += 2;
                    else results[questions[i].aB] += 2;
                }
            });
            
            // Crear nuevo gr√°fico
            createChart(results, type);
        }

        function createChart(results, type) {
            // Destruir gr√°fico anterior si existe
            if (currentChart) {
                currentChart.destroy();
            }
            
            const ctx = document.getElementById('chart').getContext('2d');
            
            if (type === 'radar') {
                currentChart = new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: Object.values(areas).map(a => a.name),
                        datasets: [{
                            label: 'Tu Puntaje',
                            data: Object.values(results),
                            backgroundColor: 'rgba(102,126,234,0.3)',
                            borderColor: '#667eea',
                            borderWidth: 3,
                            pointBackgroundColor: Object.values(areas).map(a => a.color),
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            pointRadius: 6,
                            pointHoverRadius: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            r: {
                                beginAtZero: true,
                                max: 40,
                                ticks: {
                                    stepSize: 10,
                                    font: { size: 12 }
                                },
                                pointLabels: {
                                    font: { size: 13, weight: '600' }
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top',
                                labels: { font: { size: 14, weight: '600' } }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return context.label + ': ' + context.parsed.r + '/40 puntos';
                                    }
                                }
                            }
                        }
                    }
                });
            } else if (type === 'percentile') {
                // Calcular percentiles
                const baremoKey = `${userData.sexo}_${userData.nivel.split(' ')[0]}`;
                const baremo = baremos[baremoKey] || baremos[`${userData.sexo}_5to`];
                
                const percentiles = {};
                Object.entries(results).forEach(([key, score]) => {
                    const norma = baremo[key] || 12;
                    let percentile = 50; // Por defecto percentil 50
                    
                    if (score > norma + 5) percentile = 85;
                    else if (score > norma + 3) percentile = 75;
                    else if (score > norma + 1) percentile = 60;
                    else if (score < norma - 5) percentile = 15;
                    else if (score < norma - 3) percentile = 25;
                    else if (score < norma - 1) percentile = 40;
                    
                    percentiles[key] = percentile;
                });
                
                currentChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: Object.values(areas).map(a => a.name),
                        datasets: [{
                            label: 'Percentil',
                            data: Object.values(percentiles),
                            backgroundColor: Object.values(areas).map(a => a.color),
                            borderColor: Object.values(areas).map(a => a.color),
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                title: {
                                    display: true,
                                    text: 'Percentil (%)'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return 'Percentil: ' + context.parsed.y + '%';
                                    }
                                }
                            }
                        }
                    }
                });
            } else if (type === 'comparison') {
                // Comparaci√≥n con grupo de referencia
                const baremoKey = `${userData.sexo}_${userData.nivel.split(' ')[0]}`;
                const baremo = baremos[baremoKey] || baremos[`${userData.sexo}_5to`];
                
                currentChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: Object.values(areas).map(a => a.name),
                        datasets: [
                            {
                                label: 'Tu Puntaje',
                                data: Object.values(results),
                                backgroundColor: 'rgba(102,126,234,0.3)',
                                borderColor: '#667eea',
                                borderWidth: 3,
                                pointBackgroundColor: '#667eea',
                                pointBorderColor: '#fff',
                                pointBorderWidth: 2,
                                pointRadius: 6,
                                tension: 0.3
                            },
                            {
                                label: 'Promedio de Referencia',
                                data: Object.values(baremo),
                                backgroundColor: 'rgba(255,99,132,0.3)',
                                borderColor: 'rgba(255,99,132,1)',
                                borderWidth: 3,
                                pointBackgroundColor: 'rgba(255,99,132,1)',
                                pointBorderColor: '#fff',
                                pointBorderWidth: 2,
                                pointRadius: 6,
                                tension: 0.3
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 40,
                                title: {
                                    display: true,
                                    text: 'Puntaje'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            },
                            tooltip: {
                                mode: 'index',
                                intersect: false
                            }
                        }
                    }
                });
            }
            
            currentChartType = type;
        }

        function genPsychReport(results, verac, consist) {
            const sorted = Object.entries(results).sort((a, b) => b[1] - a[1]);
            const topArea = areas[sorted[0][0]];
            const topScore = sorted[0][1];
            const secondArea = areas[sorted[1][0]];
            const secondScore = sorted[1][1];
            
            // Determinar tipo de perfil
            let perfilTipo = 'emergente';
            if (topScore >= 28) {
                perfilTipo = 'definido';
            } else if (topScore >= 20 && secondScore >= 16 && (topScore - secondScore) <= 6) {
                perfilTipo = 'multipotencial';
            } else if (topScore >= 16) {
                perfilTipo = 'emergente';
            } else {
                perfilTipo = 'disperso';
            }
            
            // Obtener interpretaci√≥n predefinida
            const interpretacion = interpretacionesPsicologicas[perfilTipo];
            
            // Interpretaci√≥n de validez
            let interp = verac >= 80 && consist >= 80 ? 
                `Los resultados presentan <strong>excelente validez</strong>. ${userData.nombre} ha respondido con honestidad, coherencia y reflexi√≥n adecuada. El perfil vocacional obtenido es confiable para la toma de decisiones.` :
                verac >= 60 && consist >= 60 ?
                `Los resultados son <strong>aceptables</strong>. Se observa variabilidad natural propia de la exploraci√≥n vocacional en ${userData.nivel}. Se recomienda complementar con otras actividades de orientaci√≥n.` :
                `Se recomienda <strong>precauci√≥n</strong> al interpretar estos resultados. Las inconsistencias detectadas pueden deberse a: respuestas apresuradas, falta de concentraci√≥n, o desconocimiento de las actividades mencionadas. <strong>Se sugiere repetir la evaluaci√≥n</strong> en mejores condiciones.`;
            
            // An√°lisis psicol√≥gico detallado seg√∫n perfil
            let analisisPsicologico = '';
            
            if (perfilTipo === 'definido') {
                analisisPsicologico = `
                    <p style="text-align: justify; line-height: 1.8; margin: 15px 0;">
                        El perfil definido observado en ${userData.nombre} indica una <strong>estructura de intereses consolidada</strong> 
                        con clara direccionalidad hacia ${topArea.name}. Esta configuraci√≥n sugiere:
                    </p>
                    <ul style="line-height: 1.8; margin-left: 25px;">
                        <li><strong>Identidad vocacional en formaci√≥n avanzada:</strong> Existe una conexi√≥n emocional y cognitiva estable con actividades del √°rea ${topArea.name}.</li>
                        <li><strong>Coherencia interna:</strong> Las preferencias muestran alineaci√≥n entre intereses, valores y posibles habilidades.</li>
                        <li><strong>Proyecci√≥n profesional clara:</strong> La capacidad de visualizarse desempe√±√°ndose en roles relacionados con ${topArea.name} est√° desarrollada.</li>
                    </ul>
                    <p style="text-align: justify; line-height: 1.8; margin: 15px 0;">
                        Psicol√≥gicamente, este perfil se asocia con <strong>mayor seguridad en la toma de decisiones</strong> 
                        y <strong>menor ansiedad vocacional</strong>. Sin embargo, es importante mantener una apertura exploratoria 
                        para evitar rigidez y permitir el desarrollo de intereses secundarios que puedan enriquecer el perfil principal.
                    </p>
                `;
            } else if (perfilTipo === 'multipotencial') {
                analisisPsicologico = `
                    <p style="text-align: justify; line-height: 1.8; margin: 15px 0;">
                        El perfil multipotencial de ${userData.nombre} revela una <strong>estructura de intereses diversificada</strong> 
                        con alta capacidad para desenvolverse en m√∫ltiples campos. Esta configuraci√≥n sugiere:
                    </p>
                    <ul style="line-height: 1.8; margin-left: 25px;">
                        <li><strong>Versatilidad cognitiva:</strong> Capacidad para conectar ideas y conceptos de diferentes √°reas, facilitando el pensamiento interdisciplinario.</li>
                        <li><strong>Adaptabilidad:</strong> Flexibilidad para desenvolverse en diversos contextos profesionales, una habilidad valiosa en el mercado laboral actual.</li>
                        <li><strong>Curiosidad intelectual:</strong> Inter√©s genuino por aprender y explorar diferentes campos del conocimiento.</li>
                    </ul>
                    <p style="text-align: justify; line-height: 1.8; margin: 15px 0;">
                        Psicol√≥gicamente, este perfil puede generar <strong>cierta indecisi√≥n vocacional</strong> 
                        debido a la multiplicidad de opciones atractivas. Es importante trabajar en estrategias de 
                        <strong>priorizaci√≥n basada en valores personales</strong> y considerar carreras que permitan 
                        combinar o integrar las √°reas de mayor inter√©s (${topArea.name} y ${secondArea.name}).
                    </p>
                `;
            } else if (perfilTipo === 'emergente') {
                analisisPsicologico = `
                    <p style="text-align: justify; line-height: 1.8; margin: 15px 0;">
                        El perfil en emergencia de ${userData.nombre} indica una <strong>etapa de construcci√≥n activa</strong> 
                        de intereses vocacionales, completamente esperable en ${userData.nivel}. Esta configuraci√≥n sugiere:
                    </p>
                    <ul style="line-height: 1.8; margin-left: 25px;">
                        <li><strong>Plasticidad vocacional:</strong> Capacidad para desarrollar nuevos intereses a medida que se expone a diferentes experiencias.</li>
                        <li><strong>Exploraci√≥n activa:</strong> Disposici√≥n para probar actividades diversas antes de consolidar preferencias.</li>
                        <li><strong>Identidad en formaci√≥n:</strong> Proceso natural de descubrimiento personal que continuar√° evolucionando.</li>
                    </ul>
                    <p style="text-align: justify; line-height: 1.8; margin: 15px 0;">
                        Psicol√≥gicamente, esta etapa se caracteriza por <strong>cierta incertidumbre</strong> que es 
                        funcional y necesaria para el desarrollo vocacional. Se recomienda <strong>experiencias variadas</strong> 
                        y <strong>reflexi√≥n guiada</strong> sobre las vivencias para facilitar la consolidaci√≥n gradual de intereses.
                    </p>
                `;
            } else {
                analisisPsicologico = `
                    <p style="text-align: justify; line-height: 1.8; margin: 15px 0;">
                        El perfil en exploraci√≥n de ${userData.nombre} muestra una <strong>etapa inicial</strong> 
                        en el desarrollo de intereses vocacionales. Esta configuraci√≥n sugiere:
                    </p>
                    <ul style="line-height: 1.8; margin-left: 25px;">
                        <li><strong>Desconocimiento de opciones:</strong> Posible falta de exposici√≥n a diferentes campos profesionales.</li>
                        <li><strong>Intereses no desarrollados:</strong> Potencial latente que requiere est√≠mulos y experiencias para manifestarse.</li>
                        <li><strong>Etapa pre-vocacional:</strong> Momento anterior a la formaci√≥n de preferencias claras.</li>
                    </ul>
                    <p style="text-align: justify; line-height: 1.8; margin: 15px 0;">
                        Psicol√≥gicamente, es fundamental <strong>propiciar experiencias exploratorias variadas</strong> 
                        sin presi√≥n de definici√≥n. Se recomienda acompa√±amiento cercano para identificar 
                        <strong>reacciones emocionales y niveles de engagement</strong> ante diferentes actividades, 
                        lo cual puede revelar intereses latentes.
                    </p>
                `;
            }
            
            // Recomendaciones personalizadas seg√∫n edad
            let recommendations = '';
            if (userData.nivel.includes('3ro') || userData.nivel.includes('1er') || userData.nivel.includes('2do')) {
                recommendations = `
                    <li>Explorar diferentes actividades extracurriculares relacionadas con tus √°reas de inter√©s</li>
                    <li>Investigar carreras universitarias a trav√©s de videos, testimonios y ferias vocacionales</li>
                    <li>Desarrollar h√°bitos de estudio y habilidades b√°sicas en tus √°reas de preferencia</li>
                    <li>Mantener un rendimiento acad√©mico equilibrado en todas las materias</li>
                `;
            } else if (userData.nivel.includes('4to') || userData.nivel.includes('3er') || userData.nivel.includes('2do Ciclo')) {
                recommendations = `
                    <li>Realizar visitas a universidades y conversar con estudiantes de las carreras de tu inter√©s</li>
                    <li>Participar en talleres, cursos o voluntariados relacionados con tus √°reas vocacionales</li>
                    <li>Investigar el campo laboral y las perspectivas profesionales de cada carrera</li>
                    <li>Fortalecer las materias acad√©micas relacionadas con tus √°reas de inter√©s</li>
                `;
            } else {
                recommendations = `
                    <li>Definir tu top 3 de carreras y analizar planes de estudio detalladamente</li>
                    <li>Conversar con profesionales que trabajen en las √°reas de tu inter√©s</li>
                    <li>Prepararte para ex√°menes de admisi√≥n en las materias requeridas</li>
                    <li>Considerar aspectos pr√°cticos: ubicaci√≥n, costos, duraci√≥n de estudios</li>
                    <li>Realizar pruebas de aptitud para confirmar tus capacidades en las √°reas elegidas</li>
                `;
            }
            
            document.getElementById('psychReport').innerHTML = `
                <div class="psych-report">
                    <h3 style="color: #667eea; font-size: 1.8rem; margin-bottom: 20px;">üß† INFORME PSICOL√ìGICO VOCACIONAL</h3>
                    
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                        <p><strong>Evaluado:</strong> ${userData.nombre}</p>
                        <p><strong>Edad:</strong> ${userData.edad} a√±os</p>
                        <p><strong>Instituci√≥n:</strong> ${userData.colegio}</p>
                        <p><strong>Nivel:</strong> ${userData.nivel}</p>
                        <p><strong>Fecha:</strong> ${new Date().toLocaleDateString('es-PE', {year: 'numeric', month: 'long', day: 'numeric'})}</p>
                    </div>
                    
                    <hr style="margin: 25px 0; border: none; border-top: 2px solid #e0e0e0;">
                    
                    <h4 style="color: #667eea; font-size: 1.4rem; margin-top: 25px;">I. VALIDEZ DE LA EVALUACI√ìN</h4>
                    <p style="text-align: justify; line-height: 1.8; margin: 15px 0;">${interp}</p>
                    
                    <div style="background: #f0f7ff; padding: 15px; border-left: 4px solid #667eea; border-radius: 5px; margin: 15px 0;">
                        <p><strong>üìä Indicadores de Validez:</strong></p>
                        <ul style="margin: 10px 0 0 20px;">
                            <li><strong>Veracidad:</strong> ${verac}% - ${verac >= 80 ? 'Excelente' : verac >= 60 ? 'Aceptable' : 'Cuestionable'}</li>
                            <li><strong>Consistencia:</strong> ${consist}% - ${consist >= 80 ? 'Alta' : consist >= 60 ? 'Media' : 'Baja'}</li>
                            <li><strong>Respuestas omitidas:</strong> ${answers.filter(a => a === null).length} de 20</li>
                            <li><strong>Contradicciones detectadas:</strong> ${contradictions.length}</li>
                        </ul>
                    </div>
                    
                    <h4 style="color: #667eea; font-size: 1.4rem; margin-top: 30px;">II. ${interpretacion.titulo}</h4>
                    <p style="text-align: justify; line-height: 1.8; margin: 15px 0;">${interpretacion.descripcion}</p>
                    
                    <h4 style="color: #667eea; font-size: 1.4rem; margin-top: 30px;">III. AN√ÅLISIS PSICOL√ìGICO DETALLADO</h4>
                    ${analisisPsicologico}
                    
                    <h4 style="color: #667eea; font-size: 1.4rem; margin-top: 30px;">IV. RECOMENDACIONES PERSONALIZADAS</h4>
                    <ul style="line-height: 1.8; margin-left: 25px;">
                        ${recommendations}
                        <li>Complementar esta evaluaci√≥n con pruebas de aptitudes y personalidad</li>
                        <li>Mantener autoevaluaci√≥n continua - los intereses evolucionan con nuevas experiencias</li>
                    </ul>
                    
                    <h4 style="color: #667eea; font-size: 1.4rem; margin-top: 30px;">V. CONSIDERACIONES FINALES</h4>
                    <p style="text-align: justify; line-height: 1.8; margin: 15px 0;">
                        La elecci√≥n vocacional es un <strong>proceso</strong>, no un evento √∫nico. Estos resultados 
                        representan tus intereses actuales, que pueden evolucionar con la maduraci√≥n personal, nuevas experiencias 
                        educativas y la exposici√≥n a diferentes campos profesionales.
                    </p>
                    
                    <p style="text-align: justify; line-height: 1.8; margin: 15px 0;">
                        No existe una "carrera perfecta" √∫nica para cada persona. Lo importante es encontrar un campo 
                        que combine tus intereses, valores, habilidades y circunstancias personales.
                    </p>
                    
                    <div style="background: #fff3cd; padding: 15px; border-left: 4px solid #ffc107; border-radius: 5px; margin-top: 20px;">
                        <p style="margin: 0;"><strong>‚ö†Ô∏è Nota Importante:</strong> Este informe es una herramienta de orientaci√≥n. 
                        Para una orientaci√≥n vocacional profunda y personalizada, se recomienda consultar con un psic√≥logo 
                        especializado en orientaci√≥n vocacional.</p>
                    </div>
                    
                    <p style="margin-top: 25px; color: #888; font-size: 0.9rem; font-style: italic; text-align: center;">
                        Informe generado por CASM-83 R2010 Versi√≥n 2.0 Mejorada con IA<br>
                        Sistema de Orientaci√≥n Vocacional Inteligente
                    </p>
                </div>
            `;
        }

        function genAreaCards(results) {
            const sorted = Object.entries(results).sort((a, b) => b[1] - a[1]);
            let html = '<h3 style="grid-column: 1/-1; text-align: center; color: #667eea; font-size: 1.8rem; margin-bottom: 20px;">üìä Puntajes por √Årea Vocacional</h3>';
            
            sorted.forEach(([key, score]) => {
                const area = areas[key];
                const pct = Math.round((score / 40) * 100);
                let nivel = 'MUY BAJO', nColor = '#E74C3C';
                
                if (pct >= 70) { nivel = 'MUY ALTO'; nColor = '#06D6A0'; }
                else if (pct >= 50) { nivel = 'ALTO'; nColor = '#4ECDC4'; }
                else if (pct >= 30) { nivel = 'MEDIO'; nColor = '#FFD166'; }
                else if (pct >= 15) { nivel = 'BAJO'; nColor = '#FF9F89'; }
                
                html += `
                    <div class="area-card tooltip">
                        <div style="font-size: 3.5rem; margin-bottom: 15px;">${area.icon}</div>
                        <h4 style="color: ${area.color}; margin: 15px 0; font-size: 1.2rem;">${area.name}</h4>
                        <div style="font-size: 2.5rem; font-weight: 700; color: ${area.color}; margin: 15px 0;">
                            ${score}/40
                        </div>
                        <div style="width: 100%; background: #e0e0e0; height: 10px; border-radius: 5px; margin: 15px 0;">
                            <div style="width: ${pct}%; background: ${area.color}; height: 100%; border-radius: 5px; transition: width 1s;"></div>
                        </div>
                        <div style="background: ${nColor}; color: white; padding: 8px 15px; border-radius: 20px; margin-top: 15px; font-weight: 700; font-size: 1rem;">
                            ${nivel}
                        </div>
                        <span class="tooltiptext">${area.description}<br><br><strong>Perfil:</strong> ${area.perfil}</span>
                    </div>
                `;
            });
            
            document.getElementById('areasGrid').innerHTML = html;
        }

        function genCareers(results) {
            const sorted = Object.entries(results).sort((a, b) => b[1] - a[1]).slice(0, 3);
            let html = '<div class="psych-report" style="margin-top: 30px;"><h3 style="color: #667eea; font-size: 1.8rem;">üíº CARRERAS PROFESIONALES RECOMENDADAS</h3>';
            html += '<p style="margin: 15px 0; line-height: 1.8;">Bas√°ndose en tus resultados, estas son las carreras m√°s afines a tu perfil vocacional actual:</p>';
            
            sorted.forEach(([key, score], index) => {
                const area = areas[key];
                const medal = ['ü•á', 'ü•à', 'ü•â'][index];
                
                html += `
                    <div style="margin: 25px 0; padding: 20px; background: linear-gradient(135deg, ${area.color}15 0%, ${area.color}05 100%); border-radius: 15px; border-left: 5px solid ${area.color}; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                            <span style="font-size: 2.5rem;">${medal}</span>
                            <div style="flex: 1;">
                                <h4 style="color: ${area.color}; font-size: 1.3rem; margin: 0;">${area.icon} ${area.name}</h4>
                                <p style="margin: 5px 0 0 0; color: #666; font-size: 0.95rem;">${area.description}</p>
                            </div>
                            <div style="text-align: center; background: ${area.color}; color: white; padding: 10px 20px; border-radius: 15px; min-width: 80px;">
                                <div style="font-size: 1.8rem; font-weight: 700;">${score}</div>
                                <div style="font-size: 0.8rem;">puntos</div>
                            </div>
                        </div>
                        <p style="margin: 15px 0 10px 0; font-weight: 600; color: #333;">üéì Carreras sugeridas:</p>
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px;">
                            ${area.carreras.map(c => `
                                <div style="background: white; padding: 12px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); border-left: 3px solid ${area.color};">
                                    <span style="font-size: 0.95rem;">‚Ä¢ ${c}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            });
            
            html += `
                <div style="margin-top: 30px; padding: 20px; background: #e8f4f8; border-radius: 15px; border-left: 5px solid #5DADE2;">
                    <h4 style="color: #5DADE2; margin-bottom: 15px;">üí° ¬øC√≥mo usar esta informaci√≥n?</h4>
                    <ul style="line-height: 2; margin-left: 20px;">
                        <li>Investiga cada carrera en profundidad: plan de estudios, duraci√≥n, universidades</li>
                        <li>Busca testimonios de profesionales y estudiantes en YouTube o redes sociales</li>
                        <li>Asiste a ferias vocacionales y charlas de orientaci√≥n universitaria</li>
                        <li>Considera realizar pasant√≠as o voluntariados en √°reas de tu inter√©s</li>
                        <li>No te limites solo a las tres primeras √°reas - explora todas tus opciones</li>
                    </ul>
                </div>
                
                <div style="margin-top: 20px; padding: 20px; background: #fff3cd; border-radius: 15px; border-left: 5px solid #FFC107;">
                    <p style="margin: 0; line-height: 1.8;">
                        <strong>üìå Nota importante:</strong> Estas son sugerencias basadas en tus intereses actuales. 
                        La decisi√≥n final debe considerar tambi√©n: tus aptitudes, valores personales, situaci√≥n econ√≥mica, 
                        oportunidades laborales en tu regi√≥n y tus metas de vida a largo plazo. 
                        <strong>No existe una elecci√≥n "perfecta"</strong>, sino aquella que mejor se adapte a tu situaci√≥n particular.
                    </p>
                </div>
            </div>`;
            
            document.getElementById('careersSection').innerHTML = html;
        }

        function genActionPlan(results) {
            const sorted = Object.entries(results).sort((a, b) => b[1] - a[1]);
            const topArea = areas[sorted[0][0]];
            
            const planHTML = `
                <div class="action-plan">
                    <h3 style="color: #667eea; font-size: 1.8rem; margin-bottom: 20px;">üìã Tu Plan de Acci√≥n Personalizado</h3>
                    <p style="margin-bottom: 30px; line-height: 1.8;">Basado en tu perfil vocacional, hemos creado un plan de acci√≥n paso a paso para guiarte en tu proceso de decisi√≥n vocacional.</p>
                    
                    <div class="timeline">
                        <div class="timeline-item">
                            <div class="timeline-content">
                                <div class="timeline-date">üéØ Inmediato (Pr√≥ximas 2 semanas)</div>
                                <h4>Investigaci√≥n Inicial</h4>
                                <ul>
                                    <li>Investiga 3 carreras del √°rea ${topArea.name}</li>
                                    <li>Busca videos y testimonios en YouTube</li>
                                    <li>Conversa con tus padres/tutores sobre tus intereses</li>
                                </ul>
                            </div>
                            <div class="timeline-dot"></div>
                        </div>
                        
                        <div class="timeline-item">
                            <div class="timeline-content">
                                <div class="timeline-date">üìö Corto Plazo (Pr√≥ximo mes)</div>
                                <h4>Exploraci√≥n Pr√°ctica</h4>
                                <ul>
                                    <li>Asiste a una charla vocacional virtual</li>
                                    <li>Contacta a un profesional del √°rea ${topArea.name}</li>
                                    <li>Realiza un test de aptitudes complementario</li>
                                </ul>
                            </div>
                            <div class="timeline-dot"></div>
                        </div>
                        
                        <div class="timeline-item">
                            <div class="timeline-content">
                                <div class="timeline-date">üéì Mediano Plazo (Pr√≥ximos 3 meses)</div>
                                <h4>Toma de Decisiones</h4>
                                <ul>
                                    <li>Visita universidades de tu inter√©s</li>
                                    <li>Eval√∫a factores pr√°cticos (costos, ubicaci√≥n)</li>
                                    <li>Prepara un ranking personal de carreras</li>
                                </ul>
                            </div>
                            <div class="timeline-dot"></div>
                        </div>
                        
                        <div class="timeline-item">
                            <div class="timeline-content">
                                <div class="timeline-date">üöÄ Largo Plazo (Pr√≥ximos 6 meses)</div>
                                <h4>Preparaci√≥n y Ejecuci√≥n</h4>
                                <ul>
                                    <li>Prep√°rate para ex√°menes de admisi√≥n</li>
                                    <li>Desarrolla habilidades clave del √°rea</li>
                                    <li>Busca becas y oportunidades financieras</li>
                                </ul>
                            </div>
                            <div class="timeline-dot"></div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 30px; padding: 20px; background: #e8f4f8; border-radius: 15px;">
                        <h4 style="color: #5DADE2; margin-bottom: 15px;">üí° Consejos Adicionales</h4>
                        <ul style="line-height: 2; margin-left: 20px;">
                            <li>Mant√©n un diario de tus descubrimientos vocacionales</li>
                            <li>No tengas miedo de cambiar de opini√≥n - es parte del proceso</li>
                            <li>Busca un mentor que te gu√≠e en esta etapa</li>
                            <li>Recuerda que esta decisi√≥n no es definitiva, puedes ajustar tu camino</li>
                        </ul>
                    </div>
                </div>
            `;
            
            document.getElementById('actionPlan').innerHTML = planHTML;
        }

        function genCareerSimulator(results) {
            const sorted = Object.entries(results).sort((a, b) => b[1] - a[1]);
            const topAreaKey = sorted[0][0];
            
            // Filtrar carreras del √°rea principal
            const carrerasArea = Object.entries(carrerasDB).filter(([key, carrera]) => carrera.area === topAreaKey);
            
            let html = `
                <div class="career-simulator">
                    <h3 style="color: #667eea; font-size: 1.8rem; margin-bottom: 20px;">üéÆ Simulador de Carreras Interactivo</h3>
                    <p style="margin-bottom: 30px; line-height: 1.8;">Explora en detalle las carreras m√°s afines a tu perfil. Haz clic en cada una para ver informaci√≥n completa.</p>
                    
                    <div id="careerCards">
            `;
            
            carrerasArea.forEach(([nombre, info]) => {
                const matchPercentage = Math.round((sorted[0][1] / 40) * 100);
                
                html += `
                    <div class="career-card" onclick="toggleCareerDetails('${nombre}')">
                        <div class="career-header">
                            <div class="career-title">${nombre}</div>
                            <div class="career-match">${matchPercentage}% Compatible</div>
                        </div>
                        <p style="color: #666; margin-bottom: 15px;">${info.descripcion}</p>
                        <div class="career-details" id="details-${nombre}" style="display: none;">
                            <div class="career-stat">
                                <i class="fas fa-clock"></i>
                                <span><strong>Duraci√≥n:</strong> ${info.duracion}</span>
                            </div>
                            <div class="career-stat">
                                <i class="fas fa-money-bill-wave"></i>
                                <span><strong>Salario:</strong> ${info.salario}</span>
                            </div>
                            <div class="career-stat">
                                <i class="fas fa-chart-line"></i>
                                <span><strong>Demanda:</strong> ${info.demanda}</span>
                            </div>
                            <div style="margin-top: 15px;">
                                <strong>Habilidades requeridas:</strong>
                                <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px;">
                                    ${info.habilidades.map(h => `<span style="background: #667eea; color: white; padding: 4px 12px; border-radius: 15px; font-size: 0.9rem;">${h}</span>`).join('')}
                                </div>
                            </div>
                            <div style="margin-top: 15px;">
                                <strong>Universidades recomendadas:</strong>
                                <div style="margin-top: 8px;">
                                    ${info.universidades.map(u => `<span style="display: inline-block; margin: 3px; padding: 4px 10px; background: #f0f0f3; border-radius: 10px; font-size: 0.9rem;">${u}</span>`).join('')}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            html += `
                    </div>
                    
                    <div style="margin-top: 30px; padding: 20px; background: #fff3cd; border-radius: 15px;">
                        <h4 style="color: #F39C12; margin-bottom: 15px;">üéØ C√≥mo usar el simulador</h4>
                        <ul style="line-height: 2; margin-left: 20px;">
                            <li>Haz clic en cada carrera para ver informaci√≥n detallada</li>
                            <li>Compara los diferentes aspectos: duraci√≥n, salario, demanda</li>
                            <li>Eval√∫a si las habilidades requeridas se alinean con tus fortalezas</li>
                            <li>Considera las universidades y sus requisitos de admisi√≥n</li>
                        </ul>
                    </div>
                </div>
            `;
            
            document.getElementById('careerSimulator').innerHTML = html;
        }

        function toggleCareerDetails(careerName) {
            const details = document.getElementById(`details-${careerName}`);
            const card = details.closest('.career-card');
            
            if (details.style.display === 'none') {
                // Ocultar todos los dem√°s detalles
                document.querySelectorAll('.career-details').forEach(d => {
                    d.style.display = 'none';
                });
                document.querySelectorAll('.career-card').forEach(c => {
                    c.classList.remove('selected');
                });
                
                // Mostrar este detalle
                details.style.display = 'block';
                card.classList.add('selected');
            } else {
                details.style.display = 'none';
                card.classList.remove('selected');
            }
        }

        function genOpportunityMap(results) {
            const sorted = Object.entries(results).sort((a, b) => b[1] - a[1]);
            const topArea = areas[sorted[0][0]];
            
            const opportunities = {
                "Hu√°nuco": { count: 15, icon: "üèîÔ∏è", description: "Oportunidades locales y regionales" },
                "Lima": { count: 45, icon: "üèôÔ∏è", description: "Mayor concentraci√≥n de empresas" },
                "Arequipa": { count: 25, icon: "üåã", description: "Sector tecnol√≥gico en crecimiento" },
                "Trujillo": { count: 20, icon: "üèñÔ∏è", description: "Industria y servicios" },
                "Cusco": { count: 18, icon: "üèõÔ∏è", description: "Turismo y cultura" },
                "Piura": { count: 22, icon: "üå¥", description: "Agricultura y agroindustria" }
            };
            
            let html = `
                <div class="opportunity-map">
                    <h3 style="color: #667eea; font-size: 1.8rem; margin-bottom: 20px;">üó∫Ô∏è Mapa de Oportunidades Laborales</h3>
                    <p style="margin-bottom: 30px; line-height: 1.8;">Descubre las oportunidades laborales para ${topArea.name} en diferentes regiones del Per√∫.</p>
                    
                    <div class="region-grid">
            `;
            
            Object.entries(opportunities).forEach(([region, data]) => {
                html += `
                    <div class="region-card">
                        <div class="region-icon">${data.icon}</div>
                        <div class="region-name">${region}</div>
                        <div class="opportunity-count">${data.count} oportunidades</div>
                        <p style="color: #666; font-size: 0.9rem; margin-top: 10px;">${data.description}</p>
                    </div>
                `;
            });
            
            html += `
                    </div>
                    
                    <div style="margin-top: 30px; padding: 20px; background: #e8f4f8; border-radius: 15px;">
                        <h4 style="color: #5DADE2; margin-bottom: 15px;">üí° Recomendaciones por regi√≥n</h4>
                        <ul style="line-height: 2; margin-left: 20px;">
                            <li><strong>Hu√°nuco:</strong> Ideal para empezar, menor costo de vida</li>
                            <li><strong>Lima:</strong> M√°s oportunidades pero mayor competencia</li>
                            <li><strong>Otras regiones:</strong> Considera la calidad de vida y crecimiento profesional</li>
                        </ul>
                    </div>
                </div>
            `;
            
            document.getElementById('opportunityMap').innerHTML = html;
        }

        function genFeasibilityMeter(results) {
            const sorted = Object.entries(results).sort((a, b) => b[1] - a[1]);
            const topArea = areas[sorted[0][0]];
            
            // Calcular factibilidad (simulado)
            const factores = {
                "Inter√©s Personal": Math.round((sorted[0][1] / 40) * 100),
                "Demanda Laboral": 85,
                "Potencial de Ingresos": 75,
                "Accesibilidad Econ√≥mica": 60,
                "Disponibilidad Local": 70
            };
            
            let html = `
                <div class="feasibility-meter">
                    <h3 style="color: #667eea; font-size: 1.8rem; margin-bottom: 20px;">üìä Evaluaci√≥n de Factibilidad para ${topArea.name}</h3>
                    <p style="margin-bottom: 30px; line-height: 1.8;">An√°lisis detallado de los factores que influyen en tu elecci√≥n vocacional.</p>
                    
                    <div class="meter-container">
            `;
            
            Object.entries(factores).forEach(([factor, value]) => {
                let color = '#E74C3C';
                if (value >= 70) color = '#06D6A0';
                else if (value >= 50) color = '#FFD166';
                
                html += `
                    <div class="meter-label">
                        <span>${factor}</span>
                        <span>${value}%</span>
                    </div>
                    <div class="meter-bar">
                        <div class="meter-fill" style="width: ${value}%; background: ${color};">
                            ${value}%
                        </div>
                    </div>
                `;
            });
            
            const promedio = Math.round(Object.values(factores).reduce((a, b) => a + b, 0) / Object.values(factores).length);
            
            html += `
                    </div>
                    
                    <div style="margin-top: 30px; padding: 20px; background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%); border-radius: 15px; border-left: 5px solid #667eea;">
                        <h4 style="color: #667eea; margin-bottom: 15px;">üìà Puntuaci√≥n General de Factibilidad</h4>
                        <div style="font-size: 2.5rem; font-weight: 700; color: #667eea; margin: 15px 0;">${promedio}%</div>
                        <p style="line-height: 1.8;">
                            ${promedio >= 80 ? '¬°Excelente! Esta √°rea vocacional tiene una alta factibilidad para ti.' :
                              promedio >= 60 ? 'Buena opci√≥n. Considera trabajar en los factores con menor puntuaci√≥n.' :
                              'Requiere evaluaci√≥n cuidadosa. Analiza alternativas o planes de mejora.'}
                        </p>
                    </div>
                </div>
            `;
            
            document.getElementById('feasibilityMeter').innerHTML = html;
        }

        function genGoalsSystem(results) {
            const sorted = Object.entries(results).sort((a, b) => b[1] - a[1]);
            const topArea = areas[sorted[0][0]];
            
            const metas = [
                { text: `Investigar 5 carreras del √°rea ${topArea.name}`, deadline: "2 semanas", checked: false },
                { text: "Contactar a un profesional del √°rea", deadline: "1 mes", checked: false },
                { text: "Asistir a una feria vocacional", deadline: "6 semanas", checked: false },
                { text: "Realizar un curso introductorio online", deadline: "2 meses", checked: false },
                { text: "Visitar una universidad de inter√©s", deadline: "3 meses", checked: false },
                { text: "Preparar portafolio de habilidades", deadline: "4 meses", checked: false }
            ];
            
            let html = `
                <div class="goals-system">
                    <h3 style="color: #667eea; font-size: 1.8rem; margin-bottom: 20px;">üéØ Sistema de Metas Vocacionales</h3>
                    <p style="margin-bottom: 30px; line-height: 1.8;">Establece y sigue tus metas para lograr una decisi√≥n vocacional informada. Marca las metas que completes.</p>
                    
                    <div id="goalsList">
            `;
            
            metas.forEach((meta, index) => {
                html += `
                    <div class="goal-item">
                        <div class="goal-checkbox" onclick="toggleGoal(${index})" id="goal-${index}">
                            ${meta.checked ? '<i class="fas fa-check"></i>' : ''}
                        </div>
                        <div class="goal-text">${meta.text}</div>
                        <div class="goal-deadline">üìÖ ${meta.deadline}</div>
                    </div>
                `;
            });
            
            html += `
                    </div>
                    
                    <div style="margin-top: 30px; padding: 20px; background: #e8f4f8; border-radius: 15px;">
                        <h4 style="color: #5DADE2; margin-bottom: 15px;">üí° Consejos para alcanzar tus metas</h4>
                        <ul style="line-height: 2; margin-left: 20px;">
                            <li>Establece fechas realistas y espec√≠ficas</li>
                            <li>Divide las metas grandes en peque√±os pasos</li>
                            <li>Celebra cada logro, por peque√±o que sea</li>
                            <li>Busca apoyo de familiares y amigos</li>
                            <li>Revisa y ajusta tus metas regularmente</li>
                        </ul>
                    </div>
                </div>
            `;
            
            document.getElementById('goalsSystem').innerHTML = html;
        }

        function toggleGoal(index) {
            const checkbox = document.getElementById(`goal-${index}`);
            checkbox.classList.toggle('checked');
            
            if (checkbox.classList.contains('checked')) {
                checkbox.innerHTML = '<i class="fas fa-check"></i>';
                showAchievement("üéØ ¬°Meta completada!");
            } else {
                checkbox.innerHTML = '';
            }
        }

        function genResourcesSection(results) {
            const sorted = Object.entries(results).sort((a, b) => b[1] - a[1]);
            const topArea = areas[sorted[0][0]];
            
            const recursos = [
                {
                    icon: "üéì",
                    title: "Beca 18",
                    description: "Beca del gobierno para estudios superiores",
                    link: "https://www.beca18.gob.pe",
                    tipo: "Beca"
                },
                {
                    icon: "üíº",
                    title: "Pronabec",
                    description: "Programa Nacional de Becas y Cr√©dito Educativo",
                    link: "https://www.pronabec.gob.pe",
                    tipo: "Beca"
                },
                {
                    icon: "üìö",
                    title: "Cursos Coursera",
                    description: "Cursos online de universidades prestigiosas",
                    link: "https://www.coursera.org",
                    tipo: "Educaci√≥n"
                },
                {
                    icon: "üî¨",
                    title: "CONCYTEC",
                    description: "Consejo Nacional de Ciencia y Tecnolog√≠a",
                    link: "https://www.concytec.gob.pe",
                    tipo: "Investigaci√≥n"
                },
                {
                    icon: "üíª",
                    title: "Platzi",
                    description: "Plataforma de cursos tecnol√≥gicos",
                    link: "https://platzi.com",
                    tipo: "Educaci√≥n"
                },
                {
                    icon: "üåü",
                    title: "J√≥venes a la Obra",
                    description: "Programa de empleo juvenil",
                    link: "https://www.jovenesalobra.gob.pe",
                    tipo: "Empleo"
                }
            ];
            
            let html = `
                <div class="resources-section">
                    <h3 style="color: #667eea; font-size: 1.8rem; margin-bottom: 20px;">üìö Recursos y Becas Disponibles</h3>
                    <p style="margin-bottom: 30px; line-height: 1.8;">Accede a becas, cursos y oportunidades para desarrollar tu potencial en ${topArea.name}.</p>
                    
                    <div class="resource-grid">
            `;
            
            recursos.forEach(recurso => {
                html += `
                    <div class="resource-card">
                        <div class="resource-icon">${recurso.icon}</div>
                        <div class="resource-title">${recurso.title}</div>
                        <div class="resource-description">${recurso.description}</div>
                        <a href="${recurso.link}" target="_blank" class="resource-link">
                            Visitar sitio <i class="fas fa-external-link-alt"></i>
                        </a>
                    </div>
                `;
            });
            
            html += `
                    </div>
                    
                    <div style="margin-top: 30px; padding: 20px; background: #fff3cd; border-radius: 15px;">
                        <h4 style="color: #F39C12; margin-bottom: 15px;">üí° Consejos para becas</h4>
                        <ul style="line-height: 2; margin-left: 20px;">
                            <li>Prepara tu solicitud con anticipaci√≥n</li>
                            <li>Mant√©n un buen rendimiento acad√©mico</li>
                            <li>Participa en actividades extracurriculares</li>
                            <li>Prepara ensayos personales aut√©nticos</li>
                            <li>Busca cartas de recomendaci√≥n s√≥lidas</li>
                        </ul>
                    </div>
                </div>
            `;
            
            document.getElementById('resourcesSection').innerHTML = html;
        }

        function genCompanies(results) {
            const sorted = Object.entries(results).sort((a, b) => b[1] - a[1]).slice(0, 3);
            let html = '<div class="psych-report" style="margin-top: 30px;"><h3 style="color: #667eea; font-size: 1.8rem;">üè¢ EMPRESAS Y ORGANIZACIONES DE REFERENCIA</h3>';
            html += '<p style="margin: 15px 0; line-height: 1.8;">Conoce algunas empresas destacadas en tus √°reas de mayor inter√©s:</p>';
            
            sorted.forEach(([key, score]) => {
                const area = areas[key];
                const empresas = empresasPorArea[key] || [];
                
                html += `
                    <div style="margin: 25px 0; padding: 20px; background: linear-gradient(135deg, ${area.color}15 0%, ${area.color}05 100%); border-radius: 15px; border-left: 5px solid ${area.color}; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                        <h4 style="color: ${area.color}; font-size: 1.3rem; margin: 0 0 15px 0;">${area.icon} Empresas en ${area.name}</h4>
                        <div class="company-grid">
                            ${empresas.map(emp => `
                                <div class="company-card">
                                    <div class="company-logo">${emp.icon}</div>
                                    <div class="company-name">${emp.name}</div>
                                    <div class="company-sector">${emp.sector}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            });
            
            html += `
                <div style="margin-top: 20px; padding: 20px; background: #e8f4f8; border-radius: 15px; border-left: 5px solid #5DADE2;">
                    <h4 style="color: #5DADE2; margin-bottom: 15px;">üí° Explora oportunidades profesionales</h4>
                    <ul style="line-height: 2; margin-left: 20px;">
                        <li>Investiga las pr√°cticas profesionales y programas de pasant√≠as en estas empresas</li>
                        <li>Sigue a estas organizaciones en redes sociales para conocer su cultura y oportunidades</li>
                        <li>Identifica las competencias y habilidades que valoran en sus procesos de selecci√≥n</li>
                        <li>Considera empresas locales y regionales que operen en los mismos sectores</li>
                    </ul>
                </div>
            </div>`;
            
            document.getElementById('companiesSection').innerHTML = html;
        }

        function setupAllCollapsibles() {
            const coll = document.getElementsByClassName("collapsible");
            for (let i = 0; i < coll.length; i++) {
                coll[i].addEventListener("click", function() {
                    this.classList.toggle("active");
                    const content = this.nextElementSibling;
                    content.classList.toggle("show");
                });
            }
        }

        // Asistente Virtual
        function toggleChat() {
            const chatWindow = document.getElementById('chatWindow');
            chatWindow.classList.toggle('show');
        }

        function addChatMessage(message, sender) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${sender}`;
            messageDiv.innerHTML = `<div class="message-bubble">${message}</div>`;
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (message) {
                addChatMessage(message, 'user');
                input.value = '';
                
                // Simular respuesta del asistente
                setTimeout(() => {
                    const response = generateAssistantResponse(message);
                    addChatMessage(response, 'assistant');
                }, 1000);
            }
        }

        function handleChatKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function generateAssistantResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            if (lowerMessage.includes('hola') || lowerMessage.includes('buenos')) {
                return respuestasAsistente.saludo[Math.floor(Math.random() * respuestasAsistente.saludo.length)];
            } else if (lowerMessage.includes('perfil') || lowerMessage.includes('resultado')) {
                const sorted = Object.entries(testResults.results).sort((a, b) => b[1] - a[1]);
                const topArea = areas[sorted[0][0]];
                return `Tu perfil vocacional muestra una clara inclinaci√≥n hacia ${topArea.name} con ${sorted[0][1]} puntos. Esto indica que tienes intereses muy definidos en esta √°rea. ¬øTe gustar√≠a saber m√°s sobre las carreras relacionadas?`;
            } else if (lowerMessage.includes('carrera') || lowerMessage.includes('estudiar')) {
                const sorted = Object.entries(testResults.results).sort((a, b) => b[1] - a[1]);
                const topArea = areas[sorted[0][0]];
                return `Para tu perfil en ${topArea.name}, te recomiendo explorar carreras como ${topArea.carreras.slice(0, 3).join(', ')}. Cada una ofrece excelentes oportunidades profesionales. ¬øQuieres detalles sobre alguna en espec√≠fico?`;
            } else if (lowerMessage.includes('siguiente') || lowerMessage.includes('ahora')) {
                return "El siguiente paso ser√≠a seguir tu Plan de Acci√≥n Personalizado. Te recomiendo comenzar investigando las carreras de tu inter√©s y buscar informaci√≥n sobre universidades. Tambi√©n puedes usar el Simulador de Carreras para explorar opciones detalladas.";
            } else if (lowerMessage.includes('duda') || lowerMessage.includes('confundido')) {
                return "Es completamente normal tener dudas en esta etapa. Lo importante es que est√°s tomando el tiempo para explorar tus opciones. Te sugiero hablar con profesionales del √°rea que te interesa y considerar hacer pasant√≠as o voluntariados para tener experiencia pr√°ctica.";
            } else {
                return respuestasAsistente.default[Math.floor(Math.random() * respuestasAsistente.default.length)];
            }
        }

        function shareResults() {
            showAchievement("üì§ ¬°Resultados listos para compartir!");
        }

        function downloadPDF() {
            showAchievement("üì• Generando PDF...");
            // Aqu√≠ se implementar√≠a la generaci√≥n real del PDF
            setTimeout(() => {
                showAchievement("‚úÖ PDF descargado correctamente");
            }, 2000);
        }

        // Ocultar loader al cargar la p√°gina
        window.addEventListener('load', () => {
            setTimeout(() => {
                document.getElementById('loader').classList.add('hidden');
            }, 1000);
        });
    </script>
</body>
</html>